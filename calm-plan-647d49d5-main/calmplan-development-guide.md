```

---

## ×ª×•×›× ×™×ª ×™×™×©×•× 24 ×©×¢×•×ª

### ×¡×§×™×¨×ª ×–×× ×™× ×•×—×œ×•×§×ª ××©×™××•×ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ×©×¢×•×ª 0-4: ×ª×©×ª×™×ª ×•Model×™× (4 ×©×¢×•×ª)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ×”×¨×—×‘×ª ×¡×›××•×ª ×§×™×™××•×ª (1 ×©×¢×”)                             â”‚
â”‚ â€¢ ×™×¦×™×¨×ª ××•×“×œ×™× ×—×“×©×™× (1 ×©×¢×”)                              â”‚
â”‚ â€¢ API endpoints ×‘×¡×™×¡×™×™× (2 ×©×¢×•×ª)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ×©×¢×•×ª 4-12: ×××©×§ ××©×ª××© (8 ×©×¢×•×ª)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ×“×£ ×ª×›× ×•×Ÿ ×©×‘×•×¢×™ (3 ×©×¢×•×ª)                                  â”‚
â”‚ â€¢ ×“×£ ×”×–× ×ª ×˜×™×¤×•×œ×™× (2 ×©×¢×•×ª)                                â”‚
â”‚ â€¢ ×œ×•×— ×‘×§×¨×” ××©×¤×—×ª×™ (2 ×©×¢×•×ª)                                â”‚
â”‚ â€¢ ××¢×§×‘ ××¦×‘ ×¨×•×— (1 ×©×¢×”)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ×©×¢×•×ª 12-18: ×œ×•×’×™×§×” ×¢×¡×§×™×ª (6 ×©×¢×•×ª)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ×× ×•×¢ ×ª×›× ×•×Ÿ ×‘×¡×™×¡×™ (3 ×©×¢×•×ª)                               â”‚
â”‚ â€¢ ×—×œ×•×§×ª ××©×™××•×ª ××©×¤×—×ª×™×•×ª (2 ×©×¢×•×ª)                          â”‚
â”‚ â€¢ ××•×˜×•××¦×™×•×ª ×¤×©×•×˜×•×ª (1 ×©×¢×”)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ×©×¢×•×ª 18-22: ××™× ×˜×’×¨×¦×™×” ×•×‘×“×™×§×•×ª (4 ×©×¢×•×ª)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ×—×™×‘×•×¨ Monday.com (2 ×©×¢×•×ª)                               â”‚
â”‚ â€¢ ×‘×“×™×§×•×ª ×•×ª×™×§×•× ×™× (2 ×©×¢×•×ª)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ×©×¢×•×ª 22-24: ×”×©×œ××•×ª ×•-Deploy (2 ×©×¢×•×ª)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ×ª×™×¢×•×“ ××”×™×¨ (30 ×“×§×•×ª)                                    â”‚
â”‚ â€¢ ×”×’×“×¨×•×ª production (30 ×“×§×•×ª)                             â”‚
â”‚ â€¢ ×‘×“×™×§×” ×¡×•×¤×™×ª (1 ×©×¢×”)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×©×¢×•×ª 0-4: ×ª×©×ª×™×ª × ×ª×•× ×™×

#### 1. ×”×¨×—×‘×ª ×¡×›××•×ª (30 ×“×§×•×ª)
```javascript
// updateSchemas.js
const updateTaskSchema = async () => {
  // ×”×•×¡×£ ×©×“×•×ª ×—×“×©×™× ×œ-Task
  await db.collection('tasks').updateMany(
    {},
    {
      $set: {
        estimatedDuration: 30,
        cognitiveLoad: 'medium',
        locationFlexibility: 'office_only',
        energyLevel: 'medium',
        bufferDays: 2,
        suitableFor: ['parent'],
        parentApprovalRequired: true
      }
    }
  );
};

// models/Task.js - ×”×•×¡×£ ×œ×¡×›××” ×”×§×™×™××ª
TaskSchema.add({
  estimatedDuration: { type: Number, default: 30 },
  cognitiveLoad: { type: String, enum: ['low', 'medium', 'high'], default: 'medium' },
  locationFlexibility: { type: String, enum: ['office_only', 'remote_possible', 'anywhere'], default: 'office_only' },
  energyLevel: { type: String, enum: ['low', 'medium', 'high'], default: 'medium' },
  bufferDays: { type: Number, default: 2 },
  suitableFor: [{ type: String, enum: ['parent', 'teen16', 'teen14'] }],
  parentApprovalRequired: { type: Boolean, default: true }
});
```

#### 2. ×™×¦×™×¨×ª ××•×“×œ×™× ×—×“×©×™× (30 ×“×§×•×ª)
```javascript
// models/WeeklySchedule.js
const WeeklyScheduleSchema = new Schema({
  userId: String,
  weekStartDate: Date,
  fixedBlocks: [{
    day: Number,
    startTime: String,
    endTime: String,
    type: String,
    isFixed: Boolean
  }],
  scheduledTasks: [{
    taskId: String,
    day: Number,
    startTime: String,
    endTime: String,
    status: String
  }]
});

// models/FamilyMember.js
const FamilyMemberSchema = new Schema({
  householdId: String,
  name: String,
  age: Number,
  role: String,
  capabilities: [String],
  maxTasksPerDay: Number
});

// models/DailyMood.js
const DailyMoodSchema = new Schema({
  userId: String,
  date: Date,
  mood: Number,
  energy: Number,
  stress: Number,
  notes: String
});
```

#### 3. API Endpoints ×‘×¡×™×¡×™×™× (2 ×©×¢×•×ª)
```javascript
// api/scheduling.js
router.post('/schedule/save-treatments', async (req, res) => {
  const { userId, treatments } = req.body;
  
  const schedule = await WeeklySchedule.findOneAndUpdate(
    { userId, weekStartDate: startOfWeek(new Date()) },
    { 
      fixedBlocks: treatments.map(t => ({
        ...t,
        type: 'treatment',
        isFixed: true
      }))
    },
    { upsert: true, new: true }
  );
  
  res.json({ success: true, schedule });
});

router.post('/schedule/generate-basic', async (req, res) => {
  const { userId } = req.body;
  
  // ××œ×’×•×¨×™×ª× ×¤×©×•×˜ - First Fit
  const tasks = await Task.find({ 
    userId, 
    status: { $ne: 'completed' },
    deadline: { $lte: addDays(new Date(), 14) }
  }).sort({ deadline: 1 });
  
  const schedule = await generateBasicSchedule(userId, tasks);
  res.json({ success: true, schedule });
});

router.post('/family/assign-task', async (req, res) => {
  const { taskId, memberId } = req.body;
  
  const task = await Task.findByIdAndUpdate(
    taskId,
    { assignedFamilyMember: memberId },
    { new: true }
  );
  
  res.json({ success: true, task });
});

router.post('/mood/check-in', async (req, res) => {
  const { userId, mood, energy, stress, notes } = req.body;
  
  const checkIn = await DailyMood.create({
    userId,
    date: new Date(),
    mood,
    energy,
    stress,
    notes
  });
  
  res.json({ success: true, checkIn });
});
```

### ×©×¢×•×ª 4-12: ×××©×§ ××©×ª××©

#### ×¡×§×¨×™×¤×˜ ×”×ª×§× ×” ××”×™×¨×”
```bash
#!/bin/bash
# quick-ui-setup.sh

# ×”×ª×§×Ÿ ×ª×œ×•×™×•×ª UI
npm install react-beautiful-dnd @dnd-kit/sortable date-fns

# ×¦×•×¨ ××‘× ×” ×ª×™×§×™×•×ª
mkdir -p src/components/scheduling
mkdir -p src/components/family
mkdir -p src/components/mood

# ×”×¢×ª×§ ×ª×‘× ×™×•×ª ×‘×¡×™×¡×™×•×ª
echo "Creating UI templates..."

# ×ª×‘× ×™×ª WeeklyPlanner
cat > src/components/scheduling/WeeklyPlanner.jsx << 'EOF'
import React, { useState, useEffect } from 'react';
import { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';

function WeeklyPlanner() {
  const [schedule, setSchedule] = useState(null);
  const [treatments, setTreatments] = useState([]);
  const days = ['×¨××©×•×Ÿ', '×©× ×™', '×©×œ×™×©×™', '×¨×‘×™×¢×™', '×—××™×©×™'];
  const hours = Array.from({ length: 11 }, (_, i) => `${i + 8}:00`);

  const handleDragEnd = (result) => {
    if (!result.destination) return;
    
    // ×œ×•×’×™×§×ª ×’×¨×™×¨×”
    console.log('Task moved:', result);
  };

  return (
    <DragDropContext onDragEnd={handleDragEnd}>
      <div className="weekly-planner p-4">
        <h2 className="text-2xl font-bold mb-4">×ª×›× ×•×Ÿ ×©×‘×•×¢×™</h2>
        
        <div className="grid grid-cols-6 gap-2">
          {/* ×¢××•×“×ª ×©×¢×•×ª */}
          <div>
            <div className="h-12"></div>
            {hours.map(hour => (
              <div key={hour} className="h-20 flex items-center justify-end pr-2">
                {hour}
              </div>
            ))}
          </div>
          
          {/* ×¢××•×“×•×ª ×™××™× */}
          {days.map((day, dayIndex) => (
            <div key={day}>
              <div className="h-12 font-semibold text-center">
                {day}
                {dayIndex === 4 && <span className="text-red-500 text-sm"> (×˜×™×¤×•×œ×™×)</span>}
              </div>
              
              <Droppable droppableId={`day-${dayIndex}`}>
                {(provided) => (
                  <div
                    ref={provided.innerRef}
                    {...provided.droppableProps}
                    className="space-y-1"
                  >
                    {/* ×›××Ÿ ×™×•×¤×™×¢×• ×”××©×™××•×ª */}
                    {provided.placeholder}
                  </div>
                )}
              </Droppable>
            </div>
          ))}
        </div>
        
        <div className="mt-6 flex gap-4">
          <button className="bg-blue-500 text-white px-4 py-2 rounded">
            ×ª×›× ×•×Ÿ ××•×˜×•××˜×™
          </button>
          <button className="bg-green-500 text-white px-4 py-2 rounded">
            ×™×™×¦×•× ×œ×œ×•×— ×©× ×”
          </button>
        </div>
      </div>
    </DragDropContext>
  );
}# CalmPlan - ××“×¨×™×š ×¤×™×ª×•×— ××§×™×£ ×œ××¢×¨×›×ª ×ª×›× ×•×Ÿ ××“×¤×˜×™×‘×™×ª ×—×›××”

## ×ª×•×›×Ÿ ×¢× ×™×™× ×™×
1. [×¡×§×™×¨×” ×›×œ×œ×™×ª](#×¡×§×™×¨×”-×›×œ×œ×™×ª)
2. [××¨×›×™×˜×§×˜×•×¨×ª ×”××¢×¨×›×ª](#××¨×›×™×˜×§×˜×•×¨×ª-×”××¢×¨×›×ª)
3. [××•×“×œ×™ × ×ª×•× ×™× ××•×¨×—×‘×™×](#××•×“×œ×™-× ×ª×•× ×™×-××•×¨×—×‘×™×)
4. [×××©×§ ××©×ª××© - ×¨×›×™×‘×™× ××¨×›×–×™×™×](#×××©×§-××©×ª××©---×¨×›×™×‘×™×-××¨×›×–×™×™×)
5. [×œ×•×’×™×§×” ×¢×¡×§×™×ª ×•××œ×’×•×¨×™×ª××™×](#×œ×•×’×™×§×”-×¢×¡×§×™×ª-×•××œ×’×•×¨×™×ª××™×)
6. [××™× ×˜×’×¨×¦×™×•×ª](#××™× ×˜×’×¨×¦×™×•×ª)
7. [×ª×•×›× ×™×ª ×™×™×©×•× 24 ×©×¢×•×ª](#×ª×•×›× ×™×ª-×™×™×©×•×-24-×©×¢×•×ª)
8. [×—×œ×•×§×ª ×¢×‘×•×“×” ×‘×™×Ÿ ×›×œ×™×](#×—×œ×•×§×ª-×¢×‘×•×“×”-×‘×™×Ÿ-×›×œ×™×)
9. [× ×¡×¤×—×™× ×•×§×•×“ ×œ×“×•×’××”](#× ×¡×¤×—×™×-×•×§×•×“-×œ×“×•×’××”)

---

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

### ×”×—×–×•×Ÿ
×™×¦×™×¨×ª ××¢×¨×›×ª × ×™×”×•×œ ××¨×›×–×™×ª ×•×—×›××” (CRM+) ×”×××—×“×ª ××ª ×›×œ×œ ×”×¤×¢×™×œ×•×ª ×”×¢×¡×§×™×ª ×•×”××™×©×™×ª, ×¢× ×“×’×© ××™×•×—×“ ×¢×œ:
- × ×™×”×•×œ ×–××Ÿ ××“×¤×˜×™×‘×™ ×”××ª×—×©×‘ ×‘××’×‘×œ×•×ª ××™×©×™×•×ª (ADHD, ××¦×‘×™ ×—×™×¨×•× ××©×¤×—×ª×™×™×)
- ×ª×›× ×•×Ÿ ×—×›× ×”××ª××™× ××©×™××•×ª ×œ×¨××•×ª ×× ×¨×’×™×” ×•×–××™× ×•×ª
- ×©×™×œ×•×‘ ××©×¤×—×ª×™ ×¢× ×—×œ×•×§×ª ×¢×•××¡ ×”×•×’× ×ª
- ××¢×§×‘ ××—×¨ ×¨×•×•×—×” × ×¤×©×™×ª ×•×× ×™×¢×ª ×©×—×™×§×”

### ××ª×’×¨×™× ×™×™×—×•×“×™×™×
- × ×™×”×•×œ ××©×¨×“ ×”× ×”×œ×ª ×—×©×‘×•× ×•×ª ×¢×¦×××™ ×¢× ×“×“×œ×™×™× ×™× ×§×©×™×—×™×
- ×”×ª××•×“×“×•×ª ×¢× ××¦×‘ ×—×™×¨×•× ××©×¤×—×ª×™ (×‘×Ÿ ×–×•×’ ×‘×©×™×§×•×)
- × ×™×”×•×œ ×‘×™×ª ×’×“×•×œ (200 ×"×¨) ×•×’×™× ×” (×—×¦×™ ×“×•× ×)
- ×©×™×œ×•×‘ 2 ×™×œ×“×™× (14, 16) ×‘×¢×–×¨×” ××‘×œ×™ ×œ×”×¢××™×¡
- ×¢×‘×•×“×” ×¢× ADHD ×”×“×•×¨×©×ª ××¢×¨×›×ª ×¤×©×•×˜×” ×•××™× ×˜×•××™×˜×™×‘×™×ª

---

## ××¨×›×™×˜×§×˜×•×¨×ª ×”××¢×¨×›×ª

### ×©×›×‘×•×ª ×”××¢×¨×›×ª
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ×××©×§ ××©×ª××© (React)               â”‚
â”‚  â€¢ ×ª×¦×•×’×ª ×©×‘×•×¢ ×“×™× ××™×ª                      â”‚
â”‚  â€¢ ×œ×•×— ××©×™××•×ª ××©×¤×—×ª×™                       â”‚
â”‚  â€¢ ××¢×§×‘ ××¦×‘ ×¨×•×—                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ×©×›×‘×ª ×œ×•×’×™×§×” (Node.js)            â”‚
â”‚  â€¢ ×× ×•×¢ ×ª×›× ×•×Ÿ ×—×›×                         â”‚
â”‚  â€¢ ×× ×•×¢ ×œ××™×“×” ×•×”×ª×××”                      â”‚
â”‚  â€¢ ×××–×Ÿ ×¢×•××¡ ××©×¤×—×ª×™                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ××™× ×˜×’×¨×¦×™×•×ª ×—×™×¦×•× ×™×•×ª                â”‚
â”‚  â€¢ Monday.com (×“×•-×›×™×•×•× ×™)                  â”‚
â”‚  â€¢ Google Calendar                         â”‚
â”‚  â€¢ PriceWise                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ××¡×“ × ×ª×•× ×™× (MongoDB)             â”‚
â”‚  â€¢ ×œ×§×•×—×•×ª, ××©×™××•×ª, ×œ×•×—×•×ª ×–×× ×™×            â”‚
â”‚  â€¢ ×¤×¨×•×¤×™×œ×™ ××©×¤×—×”, ×”×™×¡×˜×•×¨×™×™×ª ×‘×™×¦×•×¢×™×       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ××•×“×œ×™ × ×ª×•× ×™× ××•×¨×—×‘×™×

### 1. ×”×¨×—×‘×ª ××•×“×œ Task
```javascript
// ×©×“×•×ª ×—×“×©×™× ×œ××•×“×œ Task ×”×§×™×™×
const TaskSchemaExtensions = {
  // ×ª×›× ×•×Ÿ ×•×–×× ×™×
  estimatedDuration: { 
    type: Number, 
    default: 30,
    description: "××©×š ×‘×™×¦×•×¢ ××©×•×¢×¨ ×‘×“×§×•×ª" 
  },
  actualDuration: { 
    type: Number,
    description: "××©×š ×‘×™×¦×•×¢ ×‘×¤×•×¢×œ - ×œ××˜×¨×•×ª ×œ××™×“×”" 
  },
  
  // ×××¤×™×™× ×™ ×‘×™×¦×•×¢
  cognitiveLoad: { 
    type: String, 
    enum: ['low', 'medium', 'high'],
    default: 'medium',
    description: "×¨××ª ×”××××¥ ×”×§×•×’× ×™×˜×™×‘×™ ×”× ×“×¨×©" 
  },
  energyLevel: { 
    type: String, 
    enum: ['low', 'medium', 'high'],
    default: 'medium',
    description: "×¨××ª ×”×× ×¨×’×™×” ×”× ×“×¨×©×ª" 
  },
  
  // ×’××™×©×•×ª ×•××™×œ×•×¦×™×
  locationFlexibility: { 
    type: String, 
    enum: ['office_only', 'remote_possible', 'mobile_friendly', 'anywhere'],
    default: 'office_only' 
  },
  splittable: { 
    type: Boolean, 
    default: false,
    description: "×”×× × ×™×ª×Ÿ ×œ×¤×¦×œ ××ª ×”××©×™××”" 
  },
  
  // ×ª×›× ×•×Ÿ ×•×ª×œ×•×™×•×ª
  bufferDays: { 
    type: Number, 
    default: 2,
    description: "×›××” ×™××™× ×œ×¤× ×™ ×”×“×“×œ×™×™×Ÿ ×œ×”×ª×—×™×œ" 
  },
  dependencies: [{ 
    type: Schema.Types.ObjectId, 
    ref: 'Task' 
  }],
  preferredTimeOfDay: { 
    type: String, 
    enum: ['early_morning', 'morning', 'afternoon', 'evening', 'night', 'anytime'],
    default: 'anytime' 
  },
  
  // ××©×¤×—×” ×•××¦×™×œ×”
  suitableFor: [{
    type: String,
    enum: ['parent', 'teen16', 'teen14', 'anyone']
  }],
  parentApprovalRequired: { 
    type: Boolean, 
    default: true 
  },
  assignedFamilyMember: { 
    type: Schema.Types.ObjectId, 
    ref: 'FamilyMember' 
  }
}

### 3. ×××–×Ÿ ×¢×•××¡ ××©×¤×—×ª×™
```javascript
// FamilyLoadBalancer.js
class FamilyLoadBalancer {
  constructor(familyMembers) {
    this.familyMembers = familyMembers;
    this.currentLoad = {};
    this.capabilities = {};
    this.preferences = {};
    
    this.initializeLoadTracking();
  }

  initializeLoadTracking() {
    this.familyMembers.forEach(member => {
      this.currentLoad[member.id] = {
        daily: {},
        weekly: 0,
        tasks: []
      };
      this.capabilities[member.id] = member.capabilities;
      this.preferences[member.id] = member.preferences || {};
    });
  }

  async suggestAssignment(task, timeSlot) {
    const eligibleMembers = this.filterEligibleMembers(task);
    const scoredMembers = [];
    
    for (const member of eligibleMembers) {
      const score = await this.calculateAssignmentScore(member, task, timeSlot);
      scoredMembers.push({ member, score, breakdown: score.breakdown });
    }
    
    // ××™×•×Ÿ ×œ×¤×™ ×¦×™×•×Ÿ ××”×’×‘×•×” ×œ× ××•×š
    scoredMembers.sort((a, b) => b.score.total - a.score.total);
    
    // ×”×—×–×¨ ××ª 3 ×”×”×ª×××•×ª ×”×˜×•×‘×•×ª ×‘×™×•×ª×¨
    return scoredMembers.slice(0, 3).map(item => ({
      member: item.member,
      score: item.score.total,
      reasons: this.explainAssignment(item),
      warnings: this.checkAssignmentWarnings(item.member, task)
    }));
  }

  filterEligibleMembers(task) {
    return this.familyMembers.filter(member => {
      // ×‘×“×™×§×ª ×’×™×œ ××ª××™×
      if (!task.suitableFor.includes(member.role)) {
        return false;
      }
      
      // ×‘×“×™×§×ª ×™×›×•×œ×•×ª × ×“×¨×©×•×ª
      if (task.requiredCapabilities) {
        const hasAllCapabilities = task.requiredCapabilities.every(
          cap => member.capabilities.includes(cap)
        );
        if (!hasAllCapabilities) return false;
      }
      
      // ×‘×“×™×§×ª ×–××™× ×•×ª ×‘×¡×™×¡×™×ª
      if (member.currentLoad.daily[task.date] >= member.maxTasksPerDay) {
        return false;
      }
      
      return true;
    });
  }

  async calculateAssignmentScore(member, task, timeSlot) {
    const score = {
      availability: 0,
      capability: 0,
      workload: 0,
      preference: 0,
      history: 0,
      fairness: 0,
      breakdown: {}
    };
    
    // ×–××™× ×•×ª ×‘×–××Ÿ ×”×¡×¤×¦×™×¤×™
    if (this.isMemberAvailable(member, timeSlot)) {
      score.availability = 30;
      score.breakdown.availability = '×–××™×Ÿ ×‘×–××Ÿ ×”××‘×•×§×©';
    } else {
      score.availability = 0;
      score.breakdown.availability = '×œ× ×–××™×Ÿ ×‘×–××Ÿ ×”××‘×•×§×©';
    }
    
    // ×”×ª×××ª ×™×›×•×œ×•×ª
    const capabilityMatch = this.calculateCapabilityMatch(member, task);
    score.capability = capabilityMatch * 25;
    score.breakdown.capability = `${capabilityMatch * 100}% ×”×ª×××ª ×™×›×•×œ×•×ª`;
    
    // ×¢×•××¡ × ×•×›×—×™
    const currentLoadRatio = this.getCurrentLoadRatio(member);
    score.workload = (1 - currentLoadRatio) * 20;
    score.breakdown.workload = `×¢×•××¡ × ×•×›×—×™: ${Math.round(currentLoadRatio * 100)}%`;
    
    // ×”×¢×“×¤×•×ª ××™×©×™×•×ª
    if (member.preferences?.favoriteTaskTypes?.includes(task.type)) {
      score.preference = 15;
      score.breakdown.preference = '×¡×•×’ ××©×™××” ××•×¢×“×£';
    }
    
    // ×”×™×¡×˜×•×¨×™×™×ª ×‘×™×¦×•×¢×™×
    const historicalSuccess = await this.getHistoricalSuccess(member, task.type);
    score.history = historicalSuccess * 10;
    score.breakdown.history = `×”×¦×œ×—×” ×”×™×¡×˜×•×¨×™×ª: ${Math.round(historicalSuccess * 100)}%`;
    
    // ×”×•×’× ×•×ª - ×”×× ×”×—×‘×¨ ×”×–×” ×›×‘×¨ ×œ×§×— ×”×¨×‘×” ××©×™××•×ª ×”×©×‘×•×¢?
    const fairnessScore = this.calculateFairness(member);
    score.fairness = fairnessScore * 10;
    score.breakdown.fairness = `×¦×™×•×Ÿ ×”×•×’× ×•×ª: ${Math.round(fairnessScore * 100)}%`;
    
    // ×—×™×©×•×‘ ×¦×™×•×Ÿ ×›×•×œ×œ
    score.total = Object.entries(score)
      .filter(([key]) => key !== 'total' && key !== 'breakdown')
      .reduce((sum, [_, value]) => sum + value, 0);
    
    return score;
  }

  checkAssignmentWarnings(member, task) {
    const warnings = [];
    
    // ×‘×“×™×§×ª ×¢×•××¡ ×™×ª×¨ ×¤×•×˜× ×¦×™××œ×™
    const projectedLoad = this.getProjectedLoad(member, task);
    if (projectedLoad > 0.8) {
      warnings.push({
        type: 'high_load',
        message: `${member.name} ×™×”×™×” ×¢××•×¡ ×××•×“ ×× ×™×™×§×— ××©×™××” ×–×•`,
        severity: 'medium'
      });
    }
    
    // ×‘×“×™×§×ª ××©×™××•×ª ×‘×™××™ ×‘×™×ª ×¡×¤×¨
    if (member.schoolDays?.includes(task.dayOfWeek) && task.estimatedDuration > 60) {
      warnings.push({
        type: 'school_conflict',
        message: '××©×™××” ××¨×•×›×” ×‘×™×•× ×œ×™××•×“×™×',
        severity: 'low'
      });
    }
    
    // ×‘×“×™×§×ª ××•×¨×›×‘×•×ª ××•×œ ×’×™×œ
    if (member.age < 16 && task.complexity === 'complex') {
      warnings.push({
        type: 'complexity',
        message: '×”××©×™××” ×¢×©×•×™×” ×œ×”×™×•×ª ××•×¨×›×‘×ª ××“×™',
        severity: 'high'
      });
    }
    
    return warnings;
  }

  async distributeWeeklyTasks(unassignedTasks) {
    const distribution = {
      assignments: [],
      unassigned: [],
      statistics: {}
    };
    
    // ××™×•×Ÿ ××©×™××•×ª ×œ×¤×™ ×“×—×™×¤×•×ª ×•×—×©×™×‘×•×ª
    const sortedTasks = this.prioritizeFamilyTasks(unassignedTasks);
    
    for (const task of sortedTasks) {
      const suggestions = await this.suggestAssignment(task);
      
      if (suggestions.length > 0 && suggestions[0].score > 50) {
        // ×”×§×¦×” ×œ××•×¢××“ ×”×˜×•×‘ ×‘×™×•×ª×¨
        const assignment = {
          task: task,
          assignedTo: suggestions[0].member,
          score: suggestions[0].score,
          reasons: suggestions[0].reasons,
          requiresApproval: task.parentApprovalRequired
        };
        
        distribution.assignments.push(assignment);
        this.updateMemberLoad(suggestions[0].member, task);
      } else {
        // ×œ× × ××¦××” ×”×ª×××” ×˜×•×‘×”
        distribution.unassigned.push({
          task: task,
          reason: suggestions.length === 0 
            ? '××™×Ÿ ×—×‘×¨×™ ××©×¤×—×” ××ª××™××™×' 
            : '×¦×™×•×Ÿ ×”×ª×××” × ××•×š ××“×™',
          suggestions: suggestions
        });
      }
    }
    
    // ×—×™×©×•×‘ ×¡×˜×˜×™×¡×˜×™×§×•×ª
    distribution.statistics = this.calculateDistributionStats();
    
    return distribution;
  }

  generateFamilyScheduleView(weeklySchedule) {
    const familyView = {
      members: {},
      summary: {},
      recommendations: []
    };
    
    // ××¨×’×•×Ÿ ×œ×¤×™ ×—×‘×¨ ××©×¤×—×”
    this.familyMembers.forEach(member => {
      familyView.members[member.id] = {
        name: member.name,
        role: member.role,
        tasks: [],
        totalHours: 0,
        dailyBreakdown: {}
      };
    });
    
    // ××™×•×Ÿ ××©×™××•×ª ×œ×¤×™ ×—×‘×¨ ××©×¤×—×”
    weeklySchedule.scheduledTasks
      .filter(item => item.assignedTo && item.assignedTo !== weeklySchedule.userId)
      .forEach(item => {
        const memberData = familyView.members[item.assignedTo];
        if (memberData) {
          memberData.tasks.push(item);
          memberData.totalHours += item.task.estimatedDuration / 60;
          
          const day = getDayName(item.day);
          memberData.dailyBreakdown[day] = 
            (memberData.dailyBreakdown[day] || 0) + 1;
        }
      });
    
    // ×—×™×©×•×‘ ×¡×™×›×•×
    familyView.summary = {
      totalFamilyTasks: Object.values(familyView.members)
        .reduce((sum, m) => sum + m.tasks.length, 0),
      totalFamilyHours: Object.values(familyView.members)
        .reduce((sum, m) => sum + m.totalHours, 0),
      participation: {}
    };
    
    // ×—×™×©×•×‘ ××—×•×–×™ ×”×©×ª×ª×¤×•×ª
    Object.entries(familyView.members).forEach(([id, data]) => {
      familyView.summary.participation[data.name] = {
        tasks: data.tasks.length,
        hours: data.totalHours,
        percentage: (data.tasks.length / familyView.summary.totalFamilyTasks) * 100
      };
    });
    
    // ×”××œ×¦×•×ª
    familyView.recommendations = this.generateFamilyRecommendations(familyView);
    
    return familyView;
  }

  generateFamilyRecommendations(familyView) {
    const recommendations = [];
    
    // ×‘×“×™×§×ª ××™×–×•×Ÿ
    const participationRates = Object.values(familyView.summary.participation)
      .map(p => p.percentage);
    const stdDev = standardDeviation(participationRates);
    
    if (stdDev > 20) {
      recommendations.push({
        type: 'balance',
        priority: 'medium',
        message: '×™×© ×¤×¢×¨ ×’×“×•×œ ×‘×—×œ×•×§×ª ×”××©×™××•×ª ×‘×™×Ÿ ×‘× ×™ ×”××©×¤×—×”. ×›×“××™ ×œ××–×Ÿ ×™×•×ª×¨.',
        action: 'rebalanceTasks'
      });
    }
    
    // ×‘×“×™×§×ª ×¢×•××¡ ×™×ª×¨
    Object.entries(familyView.members).forEach(([id, data]) => {
      if (data.totalHours > 10) {
        recommendations.push({
          type: 'overload',
          priority: 'high',
          message: `${data.name} ××ª×•×›× ×Ÿ/×ª ×œ×™×•×ª×¨ ×-10 ×©×¢×•×ª ×”×©×‘×•×¢. ×›×“××™ ×œ×”×¤×—×™×ª.`,
          action: 'reduceLoad',
          targetMember: id
        });
      }
    });
    
    // ×”×¦×¢×•×ª ×œ×©×™×ª×•×£ ×¤×¢×•×œ×”
    const collaborativeTasks = this.identifyCollaborativeOpportunities(familyView);
    if (collaborativeTasks.length > 0) {
      recommendations.push({
        type: 'collaboration',
        priority: 'low',
        message: '×™×© ××©×™××•×ª ×©××¤×©×¨ ×œ×‘×¦×¢ ×‘×™×—×“ ×›×“×™ ×œ×—×–×§ ××ª ×”×§×©×¨ ×”××©×¤×—×ª×™.',
        tasks: collaborativeTasks
      });
    }
    
    return recommendations;
  }
};
```

### 2. ××•×“×œ WeeklySchedule
```javascript
const WeeklyScheduleSchema = new Schema({
  userId: { type: String, required: true },
  householdId: { type: String, required: true },
  weekStartDate: { type: Date, required: true },
  status: { 
    type: String, 
    enum: ['draft', 'active', 'archived'],
    default: 'draft' 
  },
  
  // ×‘×œ×•×§×™× ×§×‘×•×¢×™× (×˜×™×¤×•×œ×™×, × ×¡×™×¢×•×ª, ×•×›×•')
  fixedBlocks: [{
    day: { type: Number, min: 0, max: 6 }, // 0=×¨××©×•×Ÿ
    startTime: String, // "09:00"
    endTime: String, // "09:45"
    type: { 
      type: String, 
      enum: ['treatment', 'commute', 'personal', 'family'] 
    },
    location: String,
    assignedTo: String, // ××™ ××”××©×¤×—×”
    recurring: { type: Boolean, default: false },
    notes: String
  }],
  
  // ××©×™××•×ª ××©×•×‘×¦×•×ª
  scheduledTasks: [{
    taskId: { type: Schema.Types.ObjectId, ref: 'Task' },
    day: Number,
    startTime: String,
    endTime: String,
    location: String,
    assignedTo: { type: Schema.Types.ObjectId, ref: 'FamilyMember' },
    status: { 
      type: String, 
      enum: ['planned', 'in_progress', 'completed', 'postponed'],
      default: 'planned' 
    },
    actualStartTime: String,
    actualEndTime: String,
    completionNotes: String,
    moodBeforeTask: { type: Number, min: 1, max: 10 },
    moodAfterTask: { type: Number, min: 1, max: 10 }
  }],
  
  // ×¤×¨×•×¤×™×œ ×× ×¨×’×™×” ×¦×¤×•×™
  energyProfile: [{
    day: Number,
    timeSlot: String, // 'morning', 'afternoon', 'evening'
    expectedEnergyLevel: String, // 'low', 'medium', 'high'
    notes: String // "××—×¨×™ ×˜×™×¤×•×œ - ×× ×¨×’×™×” × ××•×›×”"
  }],
  
  // ××˜×-×“××˜×”
  metadata: {
    totalTasks: Number,
    totalFixedHours: Number,
    totalWorkHours: Number,
    familyParticipation: {
      teen16: { tasks: Number, hours: Number },
      teen14: { tasks: Number, hours: Number }
    }
  },
  
  createdAt: { type: Date, default: Date.now },
  lastModified: { type: Date, default: Date.now }
});
```

### 3. ××•×“×œ FamilyMember
```javascript
const FamilyMemberSchema = new Schema({
  householdId: { type: String, required: true },
  name: { type: String, required: true },
  role: { 
    type: String, 
    enum: ['parent', 'teen16', 'teen14'],
    required: true 
  },
  age: Number,
  
  // ×–××™× ×•×ª
  availability: [{
    dayOfWeek: Number,
    timeSlots: [{
      start: String, // "14:00"
      end: String,   // "18:00"
      notes: String  // "××—×¨×™ ×‘×™×ª ×¡×¤×¨"
    }]
  }],
  
  // ×™×›×•×œ×•×ª
  capabilities: [{
    type: String,
    enum: [
      'driving',          // × ×”×™×’×”
      'cooking_simple',   // ×‘×™×©×•×œ ×¤×©×•×˜
      'cooking_complex',  // ×‘×™×©×•×œ ××•×¨×›×‘
      'shopping',         // ×§× ×™×•×ª
      'companionship',    // ×œ×™×•×•×™
      'gardening',        // ×’×™× ×•×Ÿ
      'cleaning',         // × ×™×§×™×•×Ÿ
      'laundry',         // ×›×‘×™×¡×”
      'tech_help'        // ×¢×–×¨×” ×˜×›× ×™×ª
    ]
  }],
  
  // ×”×’×‘×œ×•×ª
  maxTasksPerDay: { type: Number, default: 2 },
  maxHoursPerDay: { type: Number, default: 2 },
  schoolDays: [Number], // ×™××™× ×‘×”× ×™×© ×‘×™×ª ×¡×¤×¨
  
  // ×¡×˜×˜×™×¡×˜×™×§×•×ª
  stats: {
    tasksCompleted: { type: Number, default: 0 },
    averageCompletionRate: { type: Number, default: 100 },
    preferredTasks: [String]
  }
});
```

### 4. ××•×“×œ DailyMoodCheck
```javascript
const DailyMoodCheckSchema = new Schema({
  userId: { type: String, required: true },
  date: { type: Date, required: true },
  
  // ×‘×“×™×§×ª ×‘×•×§×¨
  morning: {
    time: Date,
    mood: { type: Number, min: 1, max: 10 },
    energy: { type: Number, min: 1, max: 10 },
    stress: { type: Number, min: 1, max: 10 },
    sleepQuality: { type: Number, min: 1, max: 10 },
    notes: String
  },
  
  // ×‘×“×™×§×ª ×¢×¨×‘
  evening: {
    time: Date,
    mood: { type: Number, min: 1, max: 10 },
    energy: { type: Number, min: 1, max: 10 },
    stress: { type: Number, min: 1, max: 10 },
    accomplishmentFeeling: { type: Number, min: 1, max: 10 },
    notes: String
  },
  
  // ××™×¨×•×¢×™× ××™×•×—×“×™×
  significantEvents: [{
    time: Date,
    event: String,
    impact: { type: String, enum: ['positive', 'negative', 'neutral'] }
  }],
  
  // ×”××œ×¦×•×ª ×”××¢×¨×›×ª
  systemRecommendations: [{
    type: String,
    message: String,
    implemented: Boolean
  }]
});
```

---

## ×××©×§ ××©×ª××© - ×¨×›×™×‘×™× ××¨×›×–×™×™×

### 1. ×“×£ ×ª×›× ×•×Ÿ ×©×‘×•×¢×™ ×“×™× ××™
```jsx
// WeeklyPlanner.jsx
function WeeklyPlanner() {
  const [schedule, setSchedule] = useState(null);
  const [treatments, setTreatments] = useState([]);
  const [familyAvailability, setFamilyAvailability] = useState({});
  const [viewMode, setViewMode] = useState('personal'); // 'personal', 'family', 'combined'
  
  return (
    <div className="weekly-planner">
      {/* ×›×•×ª×¨×ª ×¢× ××™× ×“×™×§×˜×•×¨×™× */}
      <PlannerHeader>
        <WeekSelector 
          onWeekChange={handleWeekChange}
          highlightThursday={true} // ×”×“×’×©×ª ×™×•× ×—××™×©×™
        />
        
        <QuickStats>
          <Stat icon="ğŸ¯" label="××©×™××•×ª" value={schedule?.totalTasks} />
          <Stat icon="â°" label="×©×¢×•×ª ×¢×‘×•×“×”" value={schedule?.workHours} />
          <Stat icon="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" label="××©×™××•×ª ××©×¤×—×”" value={schedule?.familyTasks} />
          <Stat icon="âš ï¸" label="×“×“×œ×™×™× ×™× ×§×¨×•×‘×™×" value={urgentTasks.length} />
        </QuickStats>
        
        <ViewModeToggle 
          mode={viewMode} 
          onChange={setViewMode}
        />
      </PlannerHeader>
      
      {/* ×œ×•×— ×–×× ×™× ×¨××©×™ */}
      <div className="planner-body">
        {/* ×¤×× ×œ ×¦×“ - ××©×™××•×ª ×××ª×™× ×•×ª */}
        <TasksSidebar>
          <TaskFilters>
            <FilterButton icon="ğŸ§ " label="×œ×¤×™ ×¢×•××¡ ×§×•×’× ×™×˜×™×‘×™" />
            <FilterButton icon="ğŸ“" label="×œ×¤×™ ××™×§×•×" />
            <FilterButton icon="â±ï¸" label="×œ×¤×™ ××©×š" />
            <FilterButton icon="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" label="××ª××™× ×œ××©×¤×—×”" />
          </TaskFilters>
          
          <PendingTasksList 
            tasks={pendingTasks}
            onDragStart={handleDragStart}
          />
          
          <QuickAddTask>
            <input 
              placeholder="×”×•×¡×£ ××©×™××” ××”×™×¨×”..."
              onKeyPress={handleQuickAdd}
            />
          </QuickAddTask>
        </TasksSidebar>
        
        {/* ×’×¨×™×“ ×©×‘×•×¢×™ */}
        <WeeklyGrid>
          <TimeColumn>
            {generateTimeSlots().map(time => (
              <TimeSlot key={time}>{time}</TimeSlot>
            ))}
          </TimeColumn>
          
          {days.map(day => (
            <DayColumn key={day.number}>
              <DayHeader>
                <span>{day.name}</span>
                {day.number === 4 && <Badge>×™×•× ×˜×™×¤×•×œ×™×</Badge>}
              </DayHeader>
              
              {/* ×‘×œ×•×§×™× ×§×‘×•×¢×™× */}
              {getFixedBlocks(day.number).map(block => (
                <FixedBlock 
                  key={block.id}
                  {...block}
                  className={block.type}
                />
              ))}
              
              {/* ××©×™××•×ª ××©×•×‘×¦×•×ª */}
              {getScheduledTasks(day.number).map(task => (
                <ScheduledTask
                  key={task.id}
                  {...task}
                  draggable={true}
                  onDrop={handleTaskDrop}
                  onClick={() => showTaskDetails(task)}
                />
              ))}
              
              {/* ×—×œ×•× ×•×ª ×–××Ÿ ×¤× ×•×™×™× */}
              {getAvailableSlots(day.number).map(slot => (
                <AvailableSlot
                  key={slot.id}
                  {...slot}
                  onDrop={handleTaskDrop}
                  onClick={() => showSuggestions(slot)}
                />
              ))}
            </DayColumn>
          ))}
        </WeeklyGrid>
      </div>
      
      {/* ×¤×× ×œ ×ª×—×ª×•×Ÿ - ×›×œ×™× ××”×™×¨×™× */}
      <PlannerFooter>
        <ActionButton 
          icon="ğŸ¤–" 
          label="×ª×›× ×•×Ÿ ××•×˜×•××˜×™ ×—×›×"
          onClick={runSmartScheduling}
          primary
        />
        <ActionButton 
          icon="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" 
          label="×”×¦×¢ ××©×™××•×ª ×œ××©×¤×—×”"
          onClick={suggestFamilyTasks}
        />
        <ActionButton 
          icon="ğŸ“Š" 
          label="× ×™×ª×•×— ×¢×•××¡×™×"
          onClick={showWorkloadAnalysis}
        />
        <ActionButton 
          icon="ğŸ“…" 
          label="×™×™×¦×•× ×œ×œ×•×— ×©× ×”"
          onClick={exportToCalendar}
        />
      </PlannerFooter>
    </div>
  );
}
```

### 2. ×××©×§ ×”×–× ×ª ×˜×™×¤×•×œ×™× (Thursday-centric)
```jsx
// TreatmentScheduleInput.jsx
function TreatmentScheduleInput() {
  const [inputMethod, setInputMethod] = useState('manual'); // 'manual', 'photo', 'import'
  const [treatments, setTreatments] = useState([]);
  const [companionSchedule, setCompanionSchedule] = useState({});
  
  return (
    <div className="treatment-input">
      <div className="header">
        <h2>×¢×“×›×•×Ÿ ×œ×•×— ×˜×™×¤×•×œ×™× ×©×‘×•×¢×™</h2>
        <p className="subtitle">××ª×¢×“×›×Ÿ ×›×œ ×™×•× ×—××™×©×™ ×‘×¦×”×¨×™×™×</p>
      </div>
      
      {/* ×‘×—×™×¨×ª ×©×™×˜×ª ×”×–× ×” */}
      <InputMethodTabs>
        <Tab 
          active={inputMethod === 'manual'}
          onClick={() => setInputMethod('manual')}
        >
          ×”×–× ×” ×™×“× ×™×ª
        </Tab>
        <Tab 
          active={inputMethod === 'photo'}
          onClick={() => setInputMethod('photo')}
        >
          ×¦×™×œ×•× ×œ×•×— ×–×× ×™×
        </Tab>
        <Tab 
          active={inputMethod === 'import'}
          onClick={() => setInputMethod('import')}
        >
          ×™×™×‘×•× ××§×•×‘×¥
        </Tab>
      </InputMethodTabs>
      
      {/* ×”×–× ×” ×™×“× ×™×ª */}
      {inputMethod === 'manual' && (
        <ManualInput>
          {['×¨××©×•×Ÿ', '×©× ×™', '×©×œ×™×©×™', '×¨×‘×™×¢×™', '×—××™×©×™'].map((day, index) => (
            <DaySection key={day}>
              <h3>{day}</h3>
              <TreatmentSlots>
                {treatments
                  .filter(t => t.day === index)
                  .map((treatment, idx) => (
                    <TreatmentSlot key={idx}>
                      <TimeInput
                        value={treatment.startTime}
                        onChange={(time) => updateTreatment(treatment.id, { startTime: time })}
                      />
                      <span>-</span>
                      <TimeInput
                        value={treatment.endTime}
                        onChange={(time) => updateTreatment(treatment.id, { endTime: time })}
                      />
                      <Select
                        value={treatment.companion}
                        onChange={(companion) => updateTreatment(treatment.id, { companion })}
                      >
                        <option value="">×œ×œ× ×œ×™×•×•×™</option>
                        <option value="spouse">×× ×™</option>
                        <option value="daughter16">×”×‘×ª ×”×’×“×•×œ×”</option>
                      </Select>
                      <DeleteButton onClick={() => removeTreatment(treatment.id)} />
                    </TreatmentSlot>
                  ))}
                <AddButton onClick={() => addTreatment(index)}>
                  + ×”×•×¡×£ ×˜×™×¤×•×œ
                </AddButton>
              </TreatmentSlots>
            </DaySection>
          ))}
        </ManualInput>
      )}
      
      {/* ×”×¢×œ××ª ×ª××•× ×” */}
      {inputMethod === 'photo' && (
        <PhotoUpload>
          <DropZone
            accept="image/*"
            onDrop={handlePhotoUpload}
          >
            <CameraIcon />
            <p>×’×¨×•×¨ ×ª××•× ×” ××• ×œ×—×¥ ×œ×‘×—×™×¨×”</p>
          </DropZone>
          {uploadedPhoto && (
            <PhotoPreview>
              <img src={uploadedPhoto} alt="×œ×•×— ×˜×™×¤×•×œ×™×" />
              <ProcessButton onClick={processPhoto}>
                ×¢×‘×“ ×ª××•× ×” ×•×—×œ×¥ ×–×× ×™×
              </ProcessButton>
            </PhotoPreview>
          )}
        </PhotoUpload>
      )}
      
      {/* ×¡×™×›×•× ×•×—×™×©×•×‘ ×”×©×¤×¢×•×ª */}
      <ScheduleSummary>
        <h3>×¡×™×›×•× ×©×‘×•×¢×™</h3>
        <SummaryGrid>
          <SummaryItem>
            <label>×¡×”"×› ×˜×™×¤×•×œ×™×:</label>
            <value>{treatments.length}</value>
          </SummaryItem>
          <SummaryItem>
            <label>×–××Ÿ ×‘×˜×™×¤×•×œ×™×:</label>
            <value>{calculateTotalTreatmentTime()} ×©×¢×•×ª</value>
          </SummaryItem>
          <SummaryItem>
            <label>×–××Ÿ × ×¡×™×¢×•×ª:</label>
            <value>{calculateCommuteTime()} ×©×¢×•×ª</value>
          </SummaryItem>
          <SummaryItem>
            <label>×—×œ×•× ×•×ª ×¢×‘×•×“×” ×‘××©×¨×“:</label>
            <value>{calculateOfficeWindows()} ×—×œ×•× ×•×ª</value>
          </SummaryItem>
        </SummaryGrid>
        
        <Recommendations>
          <h4>×”××œ×¦×•×ª:</h4>
          <ul>
            {generateRecommendations().map((rec, idx) => (
              <li key={idx}>{rec}</li>
            ))}
          </ul>
        </Recommendations>
      </ScheduleSummary>
      
      <ActionButtons>
        <Button variant="secondary" onClick={saveDraft}>
          ×©××•×¨ ×›×˜×™×•×˜×”
        </Button>
        <Button variant="primary" onClick={generateSchedule}>
          ×¦×•×¨ ×ª×›× ×•×Ÿ ×©×‘×•×¢×™ ×—×›×
        </Button>
      </ActionButtons>
    </div>
  );
}
```

### 3. ×œ×•×— ×‘×§×¨×” ××©×¤×—×ª×™
```jsx
// FamilyDashboard.jsx
function FamilyDashboard() {
  const [familyMembers, setFamilyMembers] = useState([]);
  const [weeklyTasks, setWeeklyTasks] = useState([]);
  const [showApprovalQueue, setShowApprovalQueue] = useState(false);
  
  return (
    <div className="family-dashboard">
      <h2>××¨×›×– ×”××©×¤×—×”</h2>
      
      {/* ×›×¨×˜×™×¡×™ ×‘× ×™ ××©×¤×—×” */}
      <FamilyCards>
        {familyMembers.map(member => (
          <MemberCard key={member.id}>
            <MemberHeader>
              <Avatar>{member.name[0]}</Avatar>
              <MemberInfo>
                <h3>{member.name}</h3>
                <p>{member.age} ×©× ×™×</p>
              </MemberInfo>
            </MemberHeader>
            
            <MemberStats>
              <Stat>
                <label>××©×™××•×ª ×”×™×•×</label>
                <value>{member.todayTasks.length}/{member.maxTasksPerDay}</value>
              </Stat>
              <Stat>
                <label>×–××Ÿ ××•×©×§×¢</label>
                <value>{member.hoursToday} ×©×¢×•×ª</value>
              </Stat>
            </MemberStats>
            
            <CurrentTasks>
              {member.currentTasks.map(task => (
                <TaskChip key={task.id} status={task.status}>
                  {task.name}
                </TaskChip>
              ))}
            </CurrentTasks>
            
            <Capabilities>
              {member.capabilities.map(cap => (
                <CapabilityBadge key={cap}>
                  {getCapabilityIcon(cap)} {getCapabilityName(cap)}
                </CapabilityBadge>
              ))}
            </Capabilities>
          </MemberCard>
        ))}
      </FamilyCards>
      
      {/* ××©×™××•×ª ××©×¤×—×ª×™×•×ª ×œ×©×‘×•×¢ */}
      <WeeklyFamilyTasks>
        <h3>××©×™××•×ª ××©×¤×—×ª×™×•×ª ×”×©×‘×•×¢</h3>
        <TasksGrid>
          {weeklyTasks.map(task => (
            <FamilyTask key={task.id}>
              <TaskHeader>
                <TaskName>{task.name}</TaskName>
                <TaskBadges>
                  {task.urgent && <UrgentBadge />}
                  {task.recurring && <RecurringBadge />}
                </TaskBadges>
              </TaskHeader>
              
              <TaskDetails>
                <Detail icon="ğŸ“…">{formatDate(task.dueDate)}</Detail>
                <Detail icon="â±ï¸">{task.estimatedDuration} ×“×§×•×ª</Detail>
                <Detail icon="ğŸ“">{task.location}</Detail>
              </TaskDetails>
              
              <AssignmentSection>
                {task.assignedTo ? (
                  <AssignedTo>
                    <Avatar small>{task.assignedTo.name[0]}</Avatar>
                    <span>{task.assignedTo.name}</span>
                    {task.parentApprovalRequired && !task.approved && (
                      <ApprovalButton onClick={() => approveTask(task.id)}>
                        ××©×¨
                      </ApprovalButton>
                    )}
                  </AssignedTo>
                ) : (
                  <AssignButton onClick={() => showAssignmentOptions(task)}>
                    ×”×§×¦×” ×œ××™×©×”×•
                  </AssignButton>
                )}
              </AssignmentSection>
            </FamilyTask>
          ))}
        </TasksGrid>
      </WeeklyFamilyTasks>
      
      {/* ×ª×•×¨ ××™×©×•×¨×™× */}
      {showApprovalQueue && (
        <ApprovalQueue>
          <h3>×××ª×™×Ÿ ×œ××™×©×•×¨</h3>
          {pendingApprovals.map(item => (
            <ApprovalItem key={item.id}>
              <ItemInfo>
                <p><strong>{item.memberName}</strong> ×¨×•×¦×” ×œ×§×—×ª:</p>
                <p>{item.taskName}</p>
              </ItemInfo>
              <ApprovalActions>
                <Button variant="success" onClick={() => approve(item.id)}>
                  ××©×¨
                </Button>
                <Button variant="danger" onClick={() => reject(item.id)}>
                  ×“×—×”
                </Button>
              </ApprovalActions>
            </ApprovalItem>
          ))}
        </ApprovalQueue>
      )}
      
      {/* ×›×œ×œ×™ ×‘×™×ª ×•×˜×™×¤×™× */}
      <HouseRules>
        <h3>×›×œ×œ×™ ×”×‘×™×ª ×œ××©×™××•×ª</h3>
        <Rules>
          <Rule>ğŸ“š ×œ×™××•×“×™× ×œ×¤× ×™ ××©×™××•×ª ×‘×™×ª</Rule>
          <Rule>ğŸ® ××§×¡×™××•× 2 ××©×™××•×ª ×‘×™×•× ×œ×›×œ ×™×œ×“</Rule>
          <Rule>ğŸ’° ×‘×•× ×•×¡ ×¢×œ ××©×™××•×ª ××¢×‘×¨ ×œ××›×¡×”</Rule>
          <Rule>ğŸ¤ ×¢×–×¨×” ×”×“×“×™×ª ××¢×•×“×“×ª</Rule>
        </Rules>
      </HouseRules>
    </div>
  );
}
```

### 4. ××¢×§×‘ ××¦×‘ ×¨×•×— ×™×•××™
```jsx
// DailyMoodTracker.jsx
function DailyMoodTracker() {
  const [checkIn, setCheckIn] = useState({
    mood: 5,
    energy: 5,
    stress: 5,
    sleep: 5
  });
  const [showHistory, setShowHistory] = useState(false);
  const [insights, setInsights] = useState(null);
  
  return (
    <div className="mood-tracker">
      {/* ×‘×“×™×§×” ××”×™×¨×” */}
      <QuickCheckIn>
        <h3>××™×š ××ª ××¨×’×™×©×” ×¢×›×©×™×•?</h3>
        <p className="time">{new Date().toLocaleTimeString('he-IL')}</p>
        
        <CheckInSliders>
          <SliderItem>
            <label>
              <span>ğŸ˜”</span>
              <span>××¦×‘ ×¨×•×—</span>
              <span>ğŸ˜Š</span>
            </label>
            <Slider
              min={1}
              max={10}
              value={checkIn.mood}
              onChange={(value) => updateCheckIn('mood', value)}
              color={getMoodColor(checkIn.mood)}
            />
            <value>{checkIn.mood}/10</value>
          </SliderItem>
          
          <SliderItem>
            <label>
              <span>ğŸ”‹</span>
              <span>×× ×¨×’×™×”</span>
              <span>âš¡</span>
            </label>
            <Slider
              min={1}
              max={10}
              value={checkIn.energy}
              onChange={(value) => updateCheckIn('energy', value)}
              color={getEnergyColor(checkIn.energy)}
            />
            <value>{checkIn.energy}/10</value>
          </SliderItem>
          
          <SliderItem>
            <label>
              <span>ğŸ˜Œ</span>
              <span>×¨××ª ×œ×—×¥</span>
              <span>ğŸ˜°</span>
            </label>
            <Slider
              min={1}
              max={10}
              value={checkIn.stress}
              onChange={(value) => updateCheckIn('stress', value)}
              color={getStressColor(checkIn.stress)}
            />
            <value>{checkIn.stress}/10</value>
          </SliderItem>
          
          <SliderItem>
            <label>
              <span>ğŸ˜´</span>
              <span>××™×›×•×ª ×©×™× ×”</span>
              <span>ğŸ›ï¸</span>
            </label>
            <Slider
              min={1}
              max={10}
              value={checkIn.sleep}
              onChange={(value) => updateCheckIn('sleep', value)}
              color={getSleepColor(checkIn.sleep)}
            />
            <value>{checkIn.sleep}/10</value>
          </SliderItem>
        </CheckInSliders>
        
        <QuickNotes>
          <input
            type="text"
            placeholder="×”×¢×¨×” ×§×¦×¨×” (××•×¤×¦×™×•× ×œ×™)..."
            maxLength={100}
          />
        </QuickNotes>
        
        <SaveButton onClick={saveCheckIn}>
          ×©××•×¨ (5 ×©× ×™×•×ª) âœ¨
        </SaveButton>
      </QuickCheckIn>
      
      {/* ×ª×•×‘× ×•×ª ××™×™×“×™×•×ª */}
      {insights && (
        <InstantInsights>
          <h4>×ª×•×‘× ×•×ª</h4>
          {insights.recommendations.map((rec, idx) => (
            <Insight key={idx} type={rec.type}>
              <InsightIcon>{rec.icon}</InsightIcon>
              <InsightText>{rec.text}</InsightText>
              {rec.actionable && (
                <ActionLink onClick={() => handleInsightAction(rec)}>
                  {rec.actionText}
                </ActionLink>
              )}
            </Insight>
          ))}
        </InstantInsights>
      )}
      
      {/* ×”×™×¡×˜×•×¨×™×” ×•×’×¨×¤×™× */}
      <HistoryToggle onClick={() => setShowHistory(!showHistory)}>
        {showHistory ? '×”×¡×ª×¨' : '×”×¦×’'} ×”×™×¡×˜×•×¨×™×”
      </HistoryToggle>
      
      {showHistory && (
        <MoodHistory>
          <TimeRangeSelector>
            <option value="week">×©×‘×•×¢ ××—×¨×•×Ÿ</option>
            <option value="month">×—×•×“×© ××—×¨×•×Ÿ</option>
            <option value="custom">×˜×•×•×— ××•×ª××</option>
          </TimeRangeSelector>
          
          <MoodChart>
            {/* ×’×¨×£ ×§×•×•×™× ×¤×©×•×˜ */}
            <LineChart data={moodHistory} />
          </MoodChart>
          
          <Patterns>
            <h4>×“×¤×•×¡×™× ×©×–×™×”×™× ×•:</h4>
            <PatternList>
              {patterns.map((pattern, idx) => (
                <Pattern key={idx}>
                  <PatternIcon>{pattern.icon}</PatternIcon>
                  <PatternText>
                    <strong>{pattern.title}</strong>
                    <p>{pattern.description}</p>
                  </PatternText>
                </Pattern>
              ))}
            </PatternList>
          </Patterns>
        </MoodHistory>
      )}
    </div>
  );
}
```

---

## ×œ×•×’×™×§×” ×¢×¡×§×™×ª ×•××œ×’×•×¨×™×ª××™×

### 1. ×× ×•×¢ ×”×ª×›× ×•×Ÿ ×”×—×›×
```javascript
// SmartSchedulingEngine.js
class SmartSchedulingEngine {
  constructor(userId, weekStart) {
    this.userId = userId;
    this.weekStart = weekStart;
    this.userPreferences = null;
    this.familyMembers = null;
    this.historicalData = null;
    this.moodPatterns = null;
  }

  async generateOptimalSchedule() {
    // ×˜×¢×™× ×ª ×›×œ ×”× ×ª×•× ×™× ×”×¨×œ×•×•× ×˜×™×™×
    await this.loadAllData();
    
    // ×©×œ×‘ 1: × ×™×ª×•×— ××’×‘×œ×•×ª ×•×–××™× ×•×ª
    const constraints = await this.analyzeConstraints();
    
    // ×©×œ×‘ 2: ×“×™×¨×•×’ ×•×¡×™×•×•×’ ××©×™××•×ª
    const prioritizedTasks = await this.prioritizeAndCategorizeTasks();
    
    // ×©×œ×‘ 3: ×—×™×©×•×‘ ×—×œ×•× ×•×ª ×–××Ÿ ××•×¤×˜×™××œ×™×™×
    const timeSlots = this.calculateOptimalTimeSlots(constraints);
    
    // ×©×œ×‘ 4: ×”×ª×××ª ××©×™××•×ª ×œ×—×œ×•× ×•×ª ×–××Ÿ
    const schedule = this.matchTasksToSlots(prioritizedTasks, timeSlots);
    
    // ×©×œ×‘ 5: ×—×œ×•×§×ª ××©×™××•×ª ××©×¤×—×ª×™×•×ª
    const familySchedule = await this.distributeFamilyTasks(schedule);
    
    // ×©×œ×‘ 6: ××•×¤×˜×™××™×–×¦×™×” ×¡×•×¤×™×ª
    const optimized = this.optimizeSchedule(familySchedule);
    
    // ×©×œ×‘ 7: ×‘×“×™×§×ª ×›×œ×œ×™× ×•××™×œ×•×¦×™×
    const validated = await this.validateSchedule(optimized);
    
    return validated;
  }

  async analyzeConstraints() {
    const constraints = {
      fixed: [],
      flexible: [],
      forbidden: []
    };
    
    // ×˜×™×¤×•×œ×™× ×•×–×× ×™ × ×¡×™×¢×”
    const treatments = await this.getTreatmentSchedule();
    treatments.forEach(treatment => {
      // ×”×˜×™×¤×•×œ ×¢×¦××•
      constraints.fixed.push({
        day: treatment.day,
        start: treatment.startTime,
        end: treatment.endTime,
        type: 'treatment',
        priority: 'absolute'
      });
      
      // ×–××Ÿ × ×¡×™×¢×” ×œ×¤× ×™
      constraints.fixed.push({
        day: treatment.day,
        start: subtractMinutes(treatment.startTime, 60),
        end: treatment.startTime,
        type: 'commute',
        priority: 'absolute'
      });
      
      // ×–××Ÿ × ×¡×™×¢×” ××—×¨×™
      constraints.fixed.push({
        day: treatment.day,
        start: treatment.endTime,
        end: addMinutes(treatment.endTime, 60),
        type: 'commute',
        priority: 'absolute'
      });
    });
    
    // ×–×× ×™ ××©×¤×—×” ×§×‘×•×¢×™×
    const familyTime = await this.getFamilyConstraints();
    constraints.flexible.push(...familyTime);
    
    // ××–×•×¨×™ "××¡×•×¨" - ×–×× ×™ ×× ×•×—×” ×”×›×¨×—×™×™×
    const restPeriods = this.calculateRequiredRestPeriods();
    constraints.forbidden.push(...restPeriods);
    
    return constraints;
  }

  prioritizeAndCategorizeTasks() {
    return this.tasks.map(task => {
      const score = this.calculateTaskPriority(task);
      const category = this.categorizeTask(task);
      const familySuitability = this.assessFamilySuitability(task);
      
      return {
        ...task,
        priorityScore: score,
        category,
        familySuitability,
        schedulingPreferences: this.getTaskPreferences(task)
      };
    }).sort((a, b) => b.priorityScore - a.priorityScore);
  }

  calculateTaskPriority(task) {
    let score = 0;
    
    // ×“×—×™×¤×•×ª ×œ×¤×™ ×“×“×œ×™×™×Ÿ
    const daysUntilDeadline = differenceInDays(task.deadline, new Date());
    if (daysUntilDeadline <= 0) {
      score += 1000; // ×“×—×•×£ ×‘×™×•×ª×¨
    } else if (daysUntilDeadline <= task.bufferDays) {
      score += 500 / daysUntilDeadline;
    } else {
      score += 100 / daysUntilDeadline;
    }
    
    // ×—×©×™×‘×•×ª ×¢×¡×§×™×ª
    const businessImportance = {
      'salary': 200,
      'vat': 180,
      'reconciliation': 150,
      'reporting': 120,
      'client_urgent': 160,
      'development': 80,
      'marketing': 70,
      'admin': 50
    };
    score += businessImportance[task.category] || 30;
    
    // ×”×©×¤×¢×ª ×ª×œ×•×™×•×ª
    if (task.dependencies?.length > 0) {
      const uncompletedDeps = task.dependencies.filter(
        depId => !this.isTaskCompleted(depId)
      );
      score -= uncompletedDeps.length * 50;
    }
    
    // ×”×ª×—×©×‘×•×ª ×‘×”×™×¡×˜×•×¨×™×”
    const historicalSuccess = this.getHistoricalSuccessRate(task.type);
    score += historicalSuccess * 50;
    
    // ×”×ª×××” ×œ××¦×‘ × ×•×›×—×™
    const currentState = this.getCurrentUserState();
    if (task.cognitiveLoad === 'high' && currentState.energy < 5) {
      score -= 100; // ×œ× ××ª××™× ×›×¨×’×¢
    }
    
    return Math.max(score, 0);
  }

  calculateOptimalTimeSlots(constraints) {
    const slots = [];
    const workingHours = this.getUserWorkingHours();
    
    for (let day = 0; day < 7; day++) {
      const daySlots = [];
      let currentTime = workingHours.start;
      
      while (currentTime < workingHours.end) {
        const slot = {
          day,
          start: currentTime,
          end: addMinutes(currentTime, 30),
          quality: this.assessSlotQuality(day, currentTime),
          constraints: []
        };
        
        // ×‘×“×•×§ ×”×ª× ×’×©×•×™×•×ª ×¢× ××™×œ×•×¦×™×
        const conflicts = this.findConflicts(slot, constraints);
        if (conflicts.length === 0) {
          slot.available = true;
        } else {
          slot.available = false;
          slot.constraints = conflicts;
        }
        
        // ×”×¢×¨×š ××™×›×•×ª ×œ×¤×™ ×”×™×¡×˜×•×¨×™×” ×•××¦×‘ ×¦×¤×•×™
        slot.energyLevel = this.predictEnergyLevel(day, currentTime);
        slot.productivityScore = this.predictProductivity(day, currentTime);
        
        daySlots.push(slot);
        currentTime = addMinutes(currentTime, 30);
      }
      
      slots.push(...daySlots);
    }
    
    return slots;
  }

  matchTasksToSlots(tasks, slots) {
    const schedule = [];
    const remainingSlots = [...slots.filter(s => s.available)];
    const unscheduledTasks = [];
    
    for (const task of tasks) {
      const bestMatch = this.findBestSlotForTask(task, remainingSlots);
      
      if (bestMatch) {
        // ×©×™×‘×•×¥ ×”××©×™××”
        const scheduledItem = {
          taskId: task.id,
          task: task,
          day: bestMatch.slot.day,
          startTime: bestMatch.slot.start,
          endTime: addMinutes(bestMatch.slot.start, task.estimatedDuration),
          location: this.determineLocation(task, bestMatch.slot),
          assignedTo: task.suitableFor.includes('parent') ? this.userId : null,
          confidence: bestMatch.score,
          reason: bestMatch.reason
        };
        
        schedule.push(scheduledItem);
        
        // ×¢×“×›×•×Ÿ ×—×œ×•× ×•×ª ×–××Ÿ ×¤× ×•×™×™×
        this.updateAvailableSlots(remainingSlots, bestMatch.slot, task);
      } else {
        unscheduledTasks.push(task);
      }
    }
    
    // × ×¡×” ×œ×©×‘×¥ ××©×™××•×ª ×©× ×•×ª×¨×• ×‘×—×œ×•× ×•×ª ×¤×—×•×ª ××•×¤×˜×™××œ×™×™×
    for (const task of unscheduledTasks) {
      const fallbackSlot = this.findFallbackSlot(task, remainingSlots);
      if (fallbackSlot) {
        schedule.push({
          taskId: task.id,
          task: task,
          ...fallbackSlot,
          confidence: 'low',
          reason: 'fallback'
        });
      }
    }
    
    return schedule;
  }

  findBestSlotForTask(task, availableSlots) {
    let bestMatch = null;
    let bestScore = -1;
    
    for (const slot of availableSlots) {
      // ×‘×“×•×§ ×× ×”××©×™××” ××ª××™××” ×œ×—×œ×•×Ÿ
      if (!this.canTaskFitInSlot(task, slot)) continue;
      
      const matchScore = this.calculateMatchScore(task, slot);
      
      if (matchScore.total > bestScore) {
        bestScore = matchScore.total;
        bestMatch = {
          slot,
          score: matchScore.total,
          breakdown: matchScore,
          reason: this.explainMatch(task, slot, matchScore)
        };
      }
    }
    
    return bestMatch;
  }

  calculateMatchScore(task, slot) {
    const scores = {
      energy: 0,
      location: 0,
      timing: 0,
      productivity: 0,
      preference: 0
    };
    
    // ×”×ª×××ª ×× ×¨×’×™×”
    if (task.energyLevel === 'high' && slot.energyLevel >= 7) {
      scores.energy = 30;
    } else if (task.energyLevel === 'medium' && slot.energyLevel >= 5) {
      scores.energy = 25;
    } else if (task.energyLevel === 'low' && slot.energyLevel >= 3) {
      scores.energy = 20;
    } else {
      scores.energy = Math.max(0, 10 - Math.abs(task.energyLevel - slot.energyLevel) * 2);
    }
    
    // ×”×ª×××ª ××™×§×•×
    const slotLocation = this.getSlotLocation(slot);
    if (task.locationFlexibility === 'anywhere') {
      scores.location = 20;
    } else if (task.locationFlexibility === 'remote_possible' && slotLocation !== 'office') {
      scores.location = 25;
    } else if (task.locationFlexibility === 'office_only' && slotLocation === 'office') {
      scores.location = 30;
    } else if (task.locationFlexibility === 'mobile_friendly' && slotLocation === 'transit') {
      scores.location = 15;
    }
    
    // ×”×ª×××ª ×–××Ÿ ×‘×™×•×
    const timeOfDay = this.getTimeOfDay(slot.start);
    if (task.preferredTimeOfDay === 'anytime') {
      scores.timing = 15;
    } else if (task.preferredTimeOfDay === timeOfDay) {
      scores.timing = 30;
    } else {
      scores.timing = 5;
    }
    
    // ×¤×¨×•×“×•×§×˜×™×‘×™×•×ª ×¦×¤×•×™×”
    scores.productivity = slot.productivityScore * 0.3;
    
    // ×”×¢×“×¤×•×ª ××©×ª××©
    const userPref = this.getUserPreferenceForTaskType(task.type, slot);
    scores.preference = userPref * 0.2;
    
    // ×—×™×©×•×‘ ×¦×™×•×Ÿ ×›×•×œ×œ
    scores.total = Object.values(scores).reduce((sum, score) => sum + score, 0);
    
    return scores;
  }

  async distributeFamilyTasks(schedule) {
    const familyTasks = schedule.filter(
      item => item.task.suitableFor.some(f => f !== 'parent')
    );
    
    const balancer = new FamilyLoadBalancer(this.familyMembers);
    
    for (const item of familyTasks) {
      if (item.assignedTo) continue; // ×›×‘×¨ ××©×•×‘×¥
      
      const suggestions = await balancer.suggestAssignment(item.task, item);
      
      if (suggestions.length > 0) {
        // ×‘×—×¨ ××ª ×”×”×ª×××” ×”×˜×•×‘×” ×‘×™×•×ª×¨
        const bestMatch = suggestions[0];
        
        // ×‘×“×•×§ ×× ×“×¨×•×© ××™×©×•×¨ ×”×•×¨×”
        if (item.task.parentApprovalRequired) {
          item.assignedTo = bestMatch.member.id;
          item.status = 'pending_approval';
          item.assignmentScore = bestMatch.score;
        } else {
          item.assignedTo = bestMatch.member.id;
          item.status = 'assigned';
        }
      }
    }
    
    return schedule;
  }

  optimizeSchedule(schedule) {
    let optimized = [...schedule];
    let improved = true;
    let iterations = 0;
    const maxIterations = 10;
    
    while (improved && iterations < maxIterations) {
      improved = false;
      iterations++;
      
      // × ×¡×” ×œ×”×¤×—×™×ª "×—×•×¨×™×" ×‘×œ×•×— ×”×–×× ×™×
      const gaps = this.findScheduleGaps(optimized);
      for (const gap of gaps) {
        const filled = this.tryFillGap(gap, optimized);
        if (filled) {
          optimized = filled;
          improved = true;
        }
      }
      
      // × ×¡×” ×œ×§×‘×¥ ××©×™××•×ª ×“×•××•×ª
      const grouped = this.tryGroupSimilarTasks(optimized);
      if (grouped.length !== optimized.length) {
        optimized = grouped;
        improved = true;
      }
      
      // ××–×Ÿ ×¢×•××¡×™× ×‘×™×Ÿ ×™××™×
      const balanced = this.balanceDailyLoad(optimized);
      if (this.calculateScheduleScore(balanced) > this.calculateScheduleScore(optimized)) {
        optimized = balanced;
        improved = true;
      }
    }
    
    return optimized;
  }

  async validateSchedule(schedule) {
    const validationResults = {
      valid: true,
      warnings: [],
      errors: [],
      suggestions: []
    };
    
    // ×‘×“×™×§×ª ×”×ª× ×’×©×•×™×•×ª
    const conflicts = this.findTimeConflicts(schedule);
    if (conflicts.length > 0) {
      validationResults.valid = false;
      validationResults.errors.push(...conflicts.map(c => ({
        type: 'conflict',
        message: `×”×ª× ×’×©×•×ª ×‘×™×Ÿ ${c.task1.name} ×œ-${c.task2.name}`,
        items: [c.task1.id, c.task2.id]
      })));
    }
    
    // ×‘×“×™×§×ª ×¢×•××¡ ×™×ª×¨
    const overloadedDays = this.findOverloadedDays(schedule);
    overloadedDays.forEach(day => {
      validationResults.warnings.push({
        type: 'overload',
        message: `×™×•× ${day.name} ×¢××•×¡ ××“×™ (${day.hours} ×©×¢×•×ª)`,
        severity: day.hours > 10 ? 'high' : 'medium'
      });
    });
    
    // ×‘×“×™×§×ª ×“×“×œ×™×™× ×™×
    const missedDeadlines = this.checkDeadlines(schedule);
    missedDeadlines.forEach(task => {
      validationResults.errors.push({
        type: 'deadline',
        message: `${task.name} ×œ× ×™×©×•×‘×¥ ×œ×¤× ×™ ×”×“×“×œ×™×™×Ÿ`,
        taskId: task.id
      });
    });
    
    // ×‘×“×™×§×ª ××™×–×•×Ÿ ××©×¤×—×ª×™
    const familyBalance = this.checkFamilyBalance(schedule);
    if (!familyBalance.balanced) {
      validationResults.warnings.push({
        type: 'family_balance',
        message: familyBalance.message,
        suggestions: familyBalance.suggestions
      });
    }
    
    // ×”×¦×¢×•×ª ×œ×©×™×¤×•×¨
    const improvements = await this.suggestImprovements(schedule);
    validationResults.suggestions.push(...improvements);
    
    return {
      schedule,
      validation: validationResults
    };
  }
}
```

### 2. ×× ×•×¢ ×œ××™×“×” ×•×”×ª×××” ××™×©×™×ª
```javascript
// PersonalizationEngine.js
class PersonalizationEngine {
  constructor(userId) {
    this.userId = userId;
    this.learningData = {
      taskCompletion: [],
      timeEstimates: [],
      energyPatterns: [],
      productivityPeriods: [],
      stressIndicators: []
    };
  }

  async learnFromHistory(days = 30) {
    // ×˜×¢×Ÿ ×”×™×¡×˜×•×¨×™×™×ª ×‘×™×¦×•×¢×™×
    const history = await this.loadExecutionHistory(days);
    
    // × ×™×ª×•×— ×“×¤×•×¡×™ ×”×©×œ××ª ××©×™××•×ª
    this.analyzeCompletionPatterns(history);
    
    // × ×™×ª×•×— ×“×™×•×§ ×‘×”×¢×¨×›×•×ª ×–××Ÿ
    this.analyzeTimeEstimateAccuracy(history);
    
    // × ×™×ª×•×— ×¨××•×ª ×× ×¨×’×™×” ×œ××•×¨×š ×”×™×•×
    this.analyzeEnergyPatterns(history);
    
    // ×–×™×”×•×™ ×ª×§×•×¤×•×ª ×¤×¨×•×“×•×§×˜×™×‘×™×•×ª
    this.identifyProductivePeriods(history);
    
    // ×–×™×”×•×™ ×˜×¨×™×’×¨×™× ×œ×œ×—×¥
    this.identifyStressTriggers(history);
    
    // ×‘× ×™×™×ª ×¤×¨×•×¤×™×œ ××©×ª××© ××¢×•×“×›×Ÿ
    return this.buildUserProfile();
  }

  analyzeCompletionPatterns(history) {
    const patterns = {};
    
    // × ×™×ª×•×— ×œ×¤×™ ×¡×•×’ ××©×™××”
    history.forEach(record => {
      const taskType = record.task.type;
      if (!patterns[taskType]) {
        patterns[taskType] = {
          total: 0,
          completed: 0,
          onTime: 0,
          delayed: 0,
          postponed: 0,
          averageDelay: []
        };
      }
      
      patterns[taskType].total++;
      
      if (record.status === 'completed') {
        patterns[taskType].completed++;
        
        if (record.completedOnTime) {
          patterns[taskType].onTime++;
        } else {
          patterns[taskType].delayed++;
          const delay = differenceInMinutes(
            record.actualEndTime, 
            record.plannedEndTime
          );
          patterns[taskType].averageDelay.push(delay);
        }
      } else if (record.status === 'postponed') {
        patterns[taskType].postponed++;
      }
    });
    
    // ×—×™×©×•×‘ ×××•×¦×¢×™× ×•××—×•×–×™×
    Object.keys(patterns).forEach(type => {
      const p = patterns[type];
      p.completionRate = (p.completed / p.total) * 100;
      p.onTimeRate = (p.onTime / p.completed) * 100 || 0;
      p.averageDelayMinutes = p.averageDelay.length > 0
        ? average(p.averageDelay)
        : 0;
    });
    
    this.learningData.taskCompletion = patterns;
  }

  analyzeTimeEstimateAccuracy(history) {
    const accuracy = {};
    
    history.filter(r => r.actualDuration).forEach(record => {
      const taskType = record.task.type;
      const cognitiveLoad = record.task.cognitiveLoad;
      const key = `${taskType}_${cognitiveLoad}`;
      
      if (!accuracy[key]) {
        accuracy[key] = {
          estimates: [],
          actuals: [],
          ratios: []
        };
      }
      
      accuracy[key].estimates.push(record.task.estimatedDuration);
      accuracy[key].actuals.push(record.actualDuration);
      accuracy[key].ratios.push(
        record.actualDuration / record.task.estimatedDuration
      );
    });
    
    // ×—×™×©×•×‘ ××§×“××™ ×ª×™×§×•×Ÿ
    Object.keys(accuracy).forEach(key => {
      const data = accuracy[key];
      data.averageRatio = average(data.ratios);
      data.standardDeviation = standardDeviation(data.ratios);
      data.correctionFactor = data.averageRatio;
      
      // ×”××œ×¦×” ×œ×”×ª×××ª ×”×¢×¨×›×•×ª
      if (data.averageRatio > 1.2) {
        data.recommendation = 'increase_estimates';
        data.suggestedMultiplier = Math.min(data.averageRatio, 1.5);
      } else if (data.averageRatio < 0.8) {
        data.recommendation = 'decrease_estimates';
        data.suggestedMultiplier = Math.max(data.averageRatio, 0.7);
      } else {
        data.recommendation = 'maintain_estimates';
        data.suggestedMultiplier = 1;
      }
    });
    
    this.learningData.timeEstimates = accuracy;
  }

  analyzeEnergyPatterns(history) {
    const patterns = {
      hourly: {},
      daily: {},
      taskType: {}
    };
    
    // × ×™×ª×•×— ×œ×¤×™ ×©×¢×•×ª ×‘×™×•×
    for (let hour = 0; hour < 24; hour++) {
      patterns.hourly[hour] = {
        moodReadings: [],
        energyReadings: [],
        taskSuccess: [],
        stressLevels: []
      };
    }
    
    history.forEach(record => {
      const hour = new Date(record.startTime).getHours();
      
      if (record.moodBeforeTask) {
        patterns.hourly[hour].moodReadings.push(record.moodBeforeTask);
      }
      if (record.energyLevel) {
        patterns.hourly[hour].energyReadings.push(record.energyLevel);
      }
      if (record.status === 'completed') {
        patterns.hourly[hour].taskSuccess.push(
          record.completedOnTime ? 1 : 0.5
        );
      }
      if (record.stressLevel) {
        patterns.hourly[hour].stressLevels.push(record.stressLevel);
      }
    });
    
    // ×—×™×©×•×‘ ×××•×¦×¢×™× ×œ×›×œ ×©×¢×”
    Object.keys(patterns.hourly).forEach(hour => {
      const data = patterns.hourly[hour];
      data.averageMood = average(data.moodReadings) || 5;
      data.averageEnergy = average(data.energyReadings) || 5;
      data.successRate = average(data.taskSuccess) || 0.5;
      data.averageStress = average(data.stressLevels) || 5;
      
      // ×“×™×¨×•×’ ××™×›×•×ª ×”×©×¢×”
      data.qualityScore = 
        (data.averageMood * 0.2) +
        (data.averageEnergy * 0.3) +
        (data.successRate * 50 * 0.3) +
        ((10 - data.averageStress) * 0.2);
    });
    
    this.learningData.energyPatterns = patterns;
  }

  identifyProductivePeriods(history) {
    const periods = [];
    const hourlyData = this.learningData.energyPatterns.hourly;
    
    // ××¦× ×¨×¦×¤×™× ×©×œ ×©×¢×•×ª ×¤×¨×•×“×•×§×˜×™×‘×™×•×ª
    let currentPeriod = null;
    
    for (let hour = 0; hour < 24; hour++) {
      const quality = hourlyData[hour].qualityScore;
      
      if (quality >= 7) { // ×¡×£ ×œ×©×¢×” ×¤×¨×•×“×•×§×˜×™×‘×™×ª
        if (!currentPeriod) {
          currentPeriod = {
            start: hour,
            end: hour,
            averageQuality: quality,
            hours: [hour]
          };
        } else {
          currentPeriod.end = hour;
          currentPeriod.hours.push(hour);
          currentPeriod.averageQuality = 
            average(currentPeriod.hours.map(h => hourlyData[h].qualityScore));
        }
      } else if (currentPeriod) {
        if (currentPeriod.hours.length >= 2) { // ×œ×¤×—×•×ª 2 ×©×¢×•×ª ×¨×¦×•×¤×•×ª
          periods.push(currentPeriod);
        }
        currentPeriod = null;
      }
    }
    
    // ×¡×™×•× ×ª×§×•×¤×” ××—×¨×•× ×”
    if (currentPeriod && currentPeriod.hours.length >= 2) {
      periods.push(currentPeriod);
    }
    
    // ××™×•×Ÿ ×œ×¤×™ ××™×›×•×ª ×××•×¦×¢×ª
    periods.sort((a, b) => b.averageQuality - a.averageQuality);
    
    this.learningData.productivityPeriods = periods.map(period => ({
      ...period,
      name: this.namePeriod(period),
      recommendations: this.generatePeriodRecommendations(period)
    }));
  }

  identifyStressTriggers(history) {
    const triggers = {
      taskTypes: {},
      timeConstraints: {},
      workload: {},
      patterns: []
    };
    
    // × ×™×ª×•×— ×œ×¤×™ ×¡×•×’ ××©×™××”
    history.forEach(record => {
      if (record.stressLevel >= 7) { // ×¨××ª ×œ×—×¥ ×’×‘×•×”×”
        // ×¡×•×’ ××©×™××”
        const taskType = record.task.type;
        triggers.taskTypes[taskType] = 
          (triggers.taskTypes[taskType] || 0) + 1;
        
        // ××™×œ×•×¦×™ ×–××Ÿ
        const timeToDeadline = differenceInHours(
          record.task.deadline,
          record.startTime
        );
        if (timeToDeadline < 24) {
          triggers.timeConstraints['last_minute'] = 
            (triggers.timeConstraints['last_minute'] || 0) + 1;
        }
        
        // ×¢×•××¡ ×™×•××™
        const dailyTasks = this.getTasksForDay(
          history, 
          new Date(record.startTime)
        );
        if (dailyTasks.length > 8) {
          triggers.workload['overloaded'] = 
            (triggers.workload['overloaded'] || 0) + 1;
        }
      }
    });
    
    // ×–×™×”×•×™ ×“×¤×•×¡×™×
    triggers.patterns = this.extractStressPatterns(triggers);
    
    this.learningData.stressIndicators = triggers;
  }

  buildUserProfile() {
    return {
      userId: this.userId,
      learningData: this.learningData,
      preferences: {
        optimalWorkingHours: this.determineOptimalHours(),
        taskTypePreferences: this.determineTaskPreferences(),
        energyManagement: this.determineEnergyStrategy(),
        stressAvoidance: this.determineStressAvoidance()
      },
      recommendations: this.generatePersonalizedRecommendations()
    };
  }

  generatePersonalizedRecommendations() {
    const recommendations = [];
    
    // ×”××œ×¦×•×ª ×¢×œ ×¡××š ×“×¤×•×¡×™ ×× ×¨×’×™×”
    const topPeriods = this.learningData.productivityPeriods.slice(0, 3);
    if (topPeriods.length > 0) {
      recommendations.push({
        type: 'scheduling',
        priority: 'high',
        message: `×”×ª×§×•×¤×•×ª ×”×¤×¨×•×“×•×§×˜×™×‘×™×•×ª ×‘×™×•×ª×¨ ×©×œ×š ×”×Ÿ: ${topPeriods.map(p => p.name).join(', ')}. ×›×“××™ ×œ×ª×–××Ÿ ××©×™××•×ª ××•×¨×›×‘×•×ª ×œ×©×¢×•×ª ××œ×•.`,
        actionable: true,
        action: 'optimizeScheduleForProductivity'
      });
    }
    
    // ×”××œ×¦×•×ª ×¢×œ ×¡××š ×“×™×•×§ ×”×¢×¨×›×•×ª ×–××Ÿ
    const overestimated = Object.entries(this.learningData.timeEstimates)
      .filter(([_, data]) => data.averageRatio < 0.8);
    const underestimated = Object.entries(this.learningData.timeEstimates)
      .filter(([_, data]) => data.averageRatio > 1.2);
    
    if (underestimated.length > 0) {
      recommendations.push({
        type: 'estimation',
        priority: 'medium',
        message: `× ×¨××” ×©××ª × ×•×˜×” ×œ×”×¢×¨×™×š ×¤×—×•×ª ××“×™ ×–××Ÿ ×œ××©×™××•×ª ××¡×•×’: ${underestimated.map(([type]) => type.split('_')[0]).join(', ')}. ××•××œ×¥ ×œ×”×•×¡×™×£ 20-30% ×œ×–××Ÿ ×”××•×¢×¨×š.`,
        actionable: true,
        action: 'adjustTimeEstimates'
      });
    }
    
    // ×”××œ×¦×•×ª ×œ×× ×™×¢×ª ×œ×—×¥
    const topStressTriggers = Object.entries(this.learningData.stressIndicators.taskTypes)
      .sort(([,a], [,b]) => b - a)
      .slice(0, 3);
    
    if (topStressTriggers.length > 0) {
      recommendations.push({
        type: 'stress_management',
        priority: 'high',
        message: `××©×™××•×ª ××¡×•×’ ${topStressTriggers.map(([type]) => type).join(', ')} × ×•×˜×•×ª ×œ×’×¨×•× ×œ×œ×—×¥. ×›×“××™ ×œ×ª×–××Ÿ ××•×ª×Ÿ ×‘×ª×§×•×¤×•×ª ×¨×’×•×¢×•×ª ×•×œ×”×§×¦×•×ª ×–××Ÿ × ×•×¡×£.`,
        actionable: true,
        action: 'addBufferToStressfulTasks'
      });
    }
    
    return recommendations;
  }
}