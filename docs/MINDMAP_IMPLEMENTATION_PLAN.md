# CalmPlan Visual Command - Mind Map Layer
## תוכנית עבודה סופית לביצוע

---

## חלק א': סקירת האפיון והערות

### 1. קונספט - Single Source of Truth הויזואלי ✅ מאושר

**מה טוב:**
- המפה כ-View ולא כישות נפרדת - זה עיקרון ארכיטקטוני קריטי. כל שינוי במפה מעדכן DB ולהיפך
- ברירת מחדל Focus Mode - מונע הצפה קוגניטיבית
- ניווט היברידי (Double-click → Deep Link) - חוסך context switching

**הערות יישום:**
- המפה תהיה React component שמאזין ל-entities קיימים (Task, Client, etc.) דרך ה-base44 client
- לא צריך סכמת DB חדשה עבור צמתים - הם נגזרים מהדאטה הקיים
- נשתמש ב-`createPageUrl()` הקיים לניווט Deep Link

---

### 2. ארכיטקטורת Semantic Zoom ✅ מאושר

**3 רמות:**
| רמה | מה רואים | Zoom Level |
|------|----------|------------|
| מבט על | 5 ענפי-על + סטטוס כללי | < 0.5 |
| מבט עבודה | שירותים + אינדיקטורים כמותיים | 0.5 - 1.0 |
| מבט פרטני | לקוחות כ"עלים" + סטטוס אישי | > 1.0 |

**הערת יישום:**
- ReactFlow תומך ב-viewport events שמאפשרים לנו לשלוט מה מוצג בכל רמת זום
- נשתמש ב-`onMoveEnd` callback כדי לזהות zoom level ולהחליף תוכן צמתים
- Clustering (בועות) מעל 10 לקוחות בענף - פתרון מעולה

---

### 3. מנוע סטטוס ויזואלי (ADHD Friendly) ✅ מאושר

| אלמנט | מקור הנתונים | יישום |
|--------|-------------|-------|
| צבע (Halo) | `STATUS_CONFIG` הקיים | CSS box-shadow צבעוני |
| גודל (Weight) | ספירת משימות פתוחות per branch | `transform: scale()` דינמי |
| אנימציה (Pulse) | deadline ב-24 שעות | CSS `@keyframes pulse` |

**הערה:** כבר קיים `STATUS_CONFIG` עם צבעים (אדום/צהוב/ירוק) ב-`processTemplates.js` - נמפה ישירות

---

### 4. תפריט ימני (Quick-Action Engine) ✅ מאושר עם שינויים

**מה נבנה:**
1. שינוי סטטוס מהיר - ✅ ישיר מ-`STATUS_CONFIG`
2. שליחת תזכורת - ⏳ שלב 2 (דורש WhatsApp API)
3. צפייה במסמכים - ✅ Drawer עם `FileMetadata` entity
4. הגדר כחוזרת - ✅ מיני-טופס ל-`RecurringTasks` entity
5. העבר ל-Inbox - ✅ חדש
6. קישור לעמוד לקוח - ✅ `createPageUrl()`

**הערה:** נשתמש ב-Radix UI `ContextMenu` שכבר מותקן בפרויקט

---

### 5. פיצ'רים ייחודיים - סדרי עדיפויות

| פיצ'ר | שלב | סיבה |
|--------|------|-------|
| Inbox צף | שלב 1 | קריטי ל-ADHD workflow |
| Brain Dump | שלב 1 | יצירת משימות מהירה |
| Focus Mode ("מה עכשיו?") | שלב 1 | ברירת מחדל |
| "תצוגת רשימת היום" | שלב 1 | גשר בין מפה לביצוע |
| Calm Down + Pomodoro | שלב 2 | Nice to have |
| Cross-Linking | שלב 2 | מורכב ויזואלית |
| Context Memory ("איפה עצרתי?") | שלב 2 | דורש tracking חדש |
| Dopamine Progress | שלב 3 | אנימציות |

---

### 6. פתרון חולשות ✅ מאושר

- **100 לקוחות:** Clustering בועות - מובנה ב-ReactFlow
- **ביצוע יומי:** כפתור "רשימת היום" = פאנל צד ליניארי
- **Show on Map:** כפתור בכל עמוד קיים → ניווט למפה עם focus על הצומת

---

## חלק ב': מיפוי מלא של כל הלוחות והעמודים הקיימים

### מבנה המפה המלא - כל צומת (Node) וה-Deep Link שלו

```
🏢 CalmPlan (מרכז ראשי)
│
├── 📋 תפעול שוטף (ענף 1 - "מה עכשיו?")
│   │
│   ├── 🔴 דחופים
│   │   └── [צמתי לקוחות עם דדליין ב-48 שעות - דינמי]
│   │
│   ├── 🟡 בטיפול
│   │   └── [צמתי משימות בסטטוס in_progress - דינמי]
│   │
│   ├── 👁️ פוקוס יומי → /Home
│   │   └── [משימות היום, אירועים, מעקב תשלומים]
│   │
│   ├── ✅ כל המשימות → /Tasks
│   │   └── [סינון לפי קטגוריה, סטטוס, לקוח]
│   │
│   ├── 📊 מטריצת עדיפויות → /TaskMatrix
│   │   └── [משימות לפי דחיפות × מורכבות]
│   │
│   └── 📅 לוח שנה → /Calendar
│       └── [תצוגות יום/שבוע/חודש]
│
├── 💰 חשבות שכר (ענף 2 - "המכונה")
│   │
│   ├── 📊 לוח שכר ראשי → /PayrollDashboard
│   │   │
│   │   ├── 💵 שכר (payroll)
│   │   │   └── [לקוח₁ → קבלת נתונים → הכנת תלושים → הגהה → קליטת פקודה → רישום תשלומים → רישום רשויות]
│   │   │
│   │   ├── 🏛️ ביטוח לאומי (social_security)
│   │   │   └── [לקוח₁ → הכנת דו"ח → דיווח]
│   │   │
│   │   ├── 📑 ניכויים (deductions)
│   │   │   └── [לקוח₁ → הכנת דו"ח → דיווח]
│   │   │
│   │   ├── 💳 מס"ב עובדים (masav_employees)
│   │   │   └── [לקוח₁ → הכנת קובץ → העלאה → אישור]
│   │   │
│   │   ├── 💳 מס"ב סוציאליות (masav_social)
│   │   │   └── [לקוח₁ → הכנת קובץ → העלאה → אישור]
│   │   │
│   │   ├── 💳 מס"ב רשויות (masav_authorities)
│   │   │   └── [לקוח₁ → הכנת קובץ → העלאה → אישור]
│   │   │
│   │   ├── 💳 מס"ב ספקים (masav_suppliers)
│   │   │   └── [לקוח₁ → הכנת קובץ → העלאה → אישור]
│   │   │
│   │   ├── 📬 משלוח תלושים (payslip_sending)
│   │   │   └── [לקוח₁ → הפקה → שליחה]
│   │   │
│   │   ├── 🏛️ תשלום רשויות (authorities_payment)
│   │   │   └── [לקוח₁ → הכנת דו"ח → תשלום]
│   │   │
│   │   ├── ⚔️ תביעות מילואים (reserve_claims)
│   │   │   └── [לקוח₁ → הכנת תביעה → הגשה → מעקב]
│   │   │
│   │   └── 📋 הנחיות מס"ב ממתפעל (social_benefits)
│   │       └── [לקוח₁ → קבלת הנחיות → ביצוע]
│   │
│   └── 📈 דיווחים מרכזים תקופתיים → /PeriodicSummaryReports
│       └── [סיכומי חודש מרוכזים]
│
├── 🧾 הנה"ח ומיסים (ענף 3 - "דיווחי חובה")
│   │
│   ├── 📊 דיווחי מיסים חודשיים → /TaxReportsDashboard
│   │   │
│   │   ├── 📝 מע"מ (vat)
│   │   │   └── [לקוח₁ → קליטת הכנסות → קליטת הוצאות → הכנת דו"ח → דיווח]
│   │   │
│   │   ├── 💰 מקדמות מס הכנסה (tax_advances)
│   │   │   └── [לקוח₁ → חישוב → דיווח ותשלום]
│   │   │
│   │   └── 📄 מע"מ 874 (vat_874)
│   │       └── [לקוח₁ → הפקת נתונים → הכנת דו"ח → שידור]
│   │
│   ├── 🔄 התאמות חשבונות → /Reconciliations
│   │   └── [לקוח₁ → קבלת דפי בנק → ביצוע התאמה → טיפול בהפרשים]
│   │
│   ├── 📊 מאזנים שנתיים → /BalanceSheets
│   │   └── [לקוח₁ → איסוף חומרים → הכנת דו"ח → עיון → הגשה]
│   │
│   ├── 📚 הנהלת חשבונות (bookkeeping)
│   │   └── [לקוח₁ → קליטת הכנסות → קליטת הוצאות → התאמות]
│   │
│   └── 💼 ייעוץ (consulting)
│       └── [לקוח₁ → ביצוע ייעוץ → סיכום ותיעוד]
│
├── ➕ שירותים נוספים (ענף 4)
│   │
│   ├── 📊 לוח שירותים נוספים → /AdditionalServicesDashboard
│   │   │
│   │   ├── 📋 דיווח למתפעל (operator_reporting)
│   │   │   └── [לקוח₁ → הכנת דו"ח → שליחה]
│   │   │
│   │   └── 📋 דיווח לטמל (taml_reporting)
│   │       └── [לקוח₁ → הכנת דו"ח → שליחה]
│   │
│   └── 📊 ריכוז דיווחים חודשיים → /ClientsDashboard
│       └── [תצוגה מרוכזת של כל הלקוחות וכל השירותים]
│
├── 📝 אדמיניסטרציה (ענף 5 - "המשרד")
│   │
│   ├── 📊 לוח אדמיניסטרטיבי → /AdminTasksDashboard
│   │   │
│   │   ├── 📋 אדמיניסטרציה כללית (admin)
│   │   │   └── [משימה₁ → ביצוע]
│   │   │
│   │   ├── 📞 לחזור ללקוח (client_callback)
│   │   │   └── [לקוח₁ → ביצוע שיחה]
│   │   │
│   │   ├── 📣 מעקב שיווק (marketing_followup)
│   │   │   └── [ליד₁ → יצירת קשר → מעקב]
│   │   │
│   │   ├── 🤝 פגישות (meeting)
│   │   │   └── [לקוח₁ → תיאום → ביצוע]
│   │   │
│   │   └── 📌 כללי (general)
│   │       └── [משימות ללא קטגוריה]
│   │
│   ├── 📁 ניהול קבצים → /ClientFiles
│   │   └── [קבצים לפי לקוח]
│   │
│   └── 🏢 מרכז עסקי → /BusinessHub
│       └── [סקירה עסקית כללית]
│
├── 👥 לקוחות וצמיחה (ענף 6 - "האנשים")
│   │
│   ├── 👥 מרכז לקוחות → /ClientManagement
│   │   └── [כרטיס לקוח מלא, רשימה/גריד]
│   │
│   ├── 🎯 לידים → /Leads
│   │   └── [פייפליין מכירות]
│   │
│   ├── 📝 קליטת לקוח חדש → /ClientOnboarding
│   │   └── [טופס קליטה מלא]
│   │
│   ├── 💰 שכ"ט → /FeeManagement
│   │   └── [מעקב גביה ותשלומים]
│   │
│   ├── 📦 אוספים/קבוצות → /Collections
│   │   └── [קיבוץ לקוחות לקבוצות]
│   │
│   └── 📂 ספקים ונותני שירות → /ServiceProviders
│       └── [ניהול ספקים]
│
├── 📅 תכנון וניהול זמן (ענף 7 - "הסדר")
│   │
│   ├── 🧠 תכנון שבועי → /WeeklyPlanningDashboard
│   │   └── [סקירה שבועית אסטרטגית]
│   │
│   ├── 📊 סיכום שבועי → /WeeklySummary
│   │   └── [רטרוספקטיבה + תובנות]
│   │
│   ├── 🔁 משימות חוזרות → /RecurringTasks
│   │   └── [הגדרת תדירויות]
│   │
│   ├── ⚡ אוטומציות → /AutomationRules
│   │   └── [כללי אוטומציה]
│   │
│   ├── 📊 מעקב פרויקטים → /Projects
│   │   └── [פרויקטים עם ציר זמן]
│   │
│   ├── 🗺️ מפת דרכים → /Roadmap
│   │   └── [תכנון אסטרטגי]
│   │
│   └── 📈 אנליטיקס → /Analytics
│       └── [תובנות ודיווחים]
│
├── 📥 Inbox (ענף 8 - "החנייה" - צף תמיד)
│   └── [פריטים שנזרקו מכל מקום - טרם מוינו]
│
└── 🏠 LENA - בית וחיים (ענף 9 - אופציונלי)
    ├── 🍽️ תכנון ארוחות → /MealPlanner
    ├── 📚 השראה → /Inspiration
    └── ⚙️ הגדרות אישיות → /LifeSettings
```

### עמודי מערכת (לא חלק מהמפה - נגישים רק מהתפריט)
- `/Settings` - הגדרת פרמטרים
- `/DataImportTool` - ייבוא נתונים
- `/TestDataManager` - ניהול נתוני בדיקה
- `/EmergencyRecovery` - שחזור חירום
- `/EmergencyReset` - איפוס מערכת
- `/SystemOverview` - סקירת מערכת
- `/FullSync` - סנכרון מלא
- `/MondayIntegration` - שילוב Monday.com

---

## חלק ג': מורכבות קוגניטיבית ו-Time Blindness (T-Shirt Sizing)

### הבעיה
ADHD גורם ל"עיוורון זמן" - משימה של 5 דקות ומשימה של 5 שעות נראות אותו דבר ברשימה.
התוצאה: שיתוק החלטות. משימה גדולה = הר בלתי עביר. משימה קטנה = "רק 5 דקות" שדוחים.

### הפתרון: מידות T-Shirt למורכבות לקוח-שירות

| מידה | הגדרה | זמן משוער | ייצוג ויזואלי במפה |
|------|--------|-----------|-------------------|
| **S** | "חטף" | עד 10 דק' | עיגול קטן (scale: 0.7) |
| **M** | עבודה סטנדרטית | 30-60 דק' | עיגול רגיל (scale: 1.0) |
| **L** | Deep Work | שעתיים+ | עיגול גדול (scale: 1.4) + מסגרת מודגשת |
| **XL** | מפלצת | פיצול ימים | עיגול ענק (scale: 1.8) + מסגרת כפולה + אייקון ⚡ |

#### שדה חדש ב-DB: `complexity_score`
```javascript
// מתווסף ל-Task entity או כשדה ב-Client per service
{
  clientId: "123",
  service: "payroll",          // מפתח מ-ALL_SERVICES
  complexity: "L",             // S | M | L | XL
  estimatedMinutes: 120,       // הערכה בדקות
  mentalLoad: "high",          // low | medium | high (מעמיס מנטלית?)
  lastMentalLoadFeedback: null // פידבק מהביצוע הקודם
}
```

### פיצ'ר: "מה מתאים לי עכשיו?" (Energy Matching)

כפתור ב-Toolbar של המפה עם 3 מצבים:

| מצב | מה מוצג | מה מוסתר |
|-----|---------|----------|
| 🔋 אנרגיה נמוכה | רק S (חטיפים) | M, L, XL מעומעמים |
| ⚡ אנרגיה רגילה | S + M | L, XL מעומעמים |
| 🧠 Deep Work | לקוח L/XL **אחד בלבד** | כל השאר מוסתרים ("סוסים עם כיסויי עיניים") |

**הערך:** ב"אנרגיה נמוכה" אוספים Quick Wins (מעלים דופמין). ב-Deep Work מתמקדים בדבר אחד.

### פירוק אוטומטי של L/XL (Deconstruction)

לקוח שמוגדר L או XL לא מופיע כצומת אחד - הוא הופך ל"צומת מתרחב":

```
[לקוח XL: חברת ABC] ← לחיצה
    │
    ├── 📥 קליטת חומר (15 דק')      [✅]
    ├── 🔍 בדיקת התאמות (60 דק')    [🔄 בעבודה]
    ├── 📊 הפקה (60 דק')             [ ]
    └── ✅ בקרה (30 דק')              [ ]
```

**הערך:** המוח לא רואה "מפלצת של 5 שעות" אלא 4 משימות קטנות וניתנות לעיכול.

### "מדד שחיקה" (Mental Load Indicator)

אייקון 🧠 ליד לקוחות שמוגדרים כ-`mentalLoad: "high"` (נודניקים, מורכבים רגשית).
- המערכת מונעת תזמון של 3+ לקוחות "כבדים מנטלית" באותו יום
- אזהרה ויזואלית: "3 לקוחות עם עומס מנטלי גבוה היום - בטוח?"

### תפריט ימני חכם: "כמה זמן יש לי?"

לחיצה ימנית על ענף ראשי (למשל "שכר") → אפשרויות:

| בחירה | תוצאה |
|-------|--------|
| "יש לי 15 דקות" | מציג רק לקוחות S בענף |
| "יש לי שעה" | מציג S + M |
| "נכנס ל-Deep Work" | מציג לקוח L/XL אחד + Calm Down mode |

---

## חלק ג.2: תהליכי קליטה דינמיים ועבודה במנות (Batches)

### הבעיה
שלבי תהליך כמו "קליטת הוצאות" לא מתנהגים אותו דבר עבור כל הלקוחות:
- **לקוח קטן:** קליטה אחת בחודש, 5 דקות, סגור
- **לקוח גדול:** 3-4 סבבי קליטה בחודש, השלמות לפני מע"מ
- **לקוח OCR:** רק לוודא שנתקבלו חומרים, לפענח, לקלוט, לסגור

### פתרון 1: מד-צבירה (Accumulation Gauge)

במקום checkbox (בוצע/לא), צומת "קליטת הוצאות" מציג סוללה של 4 שלבים:

```
┌───────────────────────────┐
│ 📥 קליטת הוצאות - אברהם  │
│                           │
│ [████████░░░░░░░░] 50%    │
│                           │
│ ✅ חומר ב-OCR             │
│ ✅ פוענח                   │
│ ○  נקלט                   │
│ ○  סגור                   │
└───────────────────────────┘
```

**התנהגות לפי סוג לקוח:**
- **לקוח קטן:** הסוללה מתמלאת בבת אחת (פעם בחודש)
- **לקוח גדול:** הסוללה עומדת על 50% לאורך החודש, מגיעה ל-100% לקראת מע"מ
- **הערך:** מונע חרדה של "שכחתי לקלוט" - פשוט רואים כמה "טעון" כל לקוח

### פתרון 2: הבחנה בין "בקרה" ל"ביצוע" (Check vs. Do)

שני סוגי צמתים שונים:

| סוג | ייצוג ויזואלי | התנהגות |
|-----|--------------|---------|
| **ביצוע** (Do) | עיגול מלא + מד צבירה | דורש עבודה אקטיבית |
| **בקרה** (Check) | עיגול חלול מהבהב | רק צריך לוודא ולשחרר |

**לקוח "בקרה" (OCR):** עיגול חלול. כשמגיע חומר חדש ב-OCR → מתחיל להבהב.
לחיצה אחת על "בוצע" = מאפס הבהוב עד חומר הבא.
**הערך:** העבודה הופכת ל"כיבוי אורות" - לא מחפשים עבודה, רק מגיבים לאורות.

### פתרון 3: תצוגת "סבבים" ללקוחות גדולים (Staging View)

לחיצה על ענף "קליטת הוצאות" של לקוח גדול → תת-מפה:

```
קליטת הוצאות - חברת מגה
│
├── סבב א' (תחילת חודש)  [✅ נקלט]
├── סבב ב' (אמצע חודש)   [✅ נקלט]
├── סבב ג' (השלמות מע"מ)  [○ ממתין]
└── סגירה לדיווח           [🔒 נעול עד שכולם ✅]
```

**הערך:** ADHD גורם להרגשה ש"לא עשית כלום" כשהמשימה הכללית ("מע"מ") עדיין פתוחה.
כאן רואים: סיימת 2 סבבים בהצלחה! נותר רק 1.

### פתרון 4: תפריט ימני ייעודי לתהליכי קליטה

לחיצה ימנית על לקוח בענף "הוצאות":

1. **"פתח OCR"** → קישור ישיר לעמוד הלקוח במערכת OCR
2. **"סמן כנקלט חלקית"** → צבע כתום-מקווקו (= "עצרתי באמצע")
3. **"הקפץ דרישת חומר"** → שליחת הודעה אוטומטית: "העלית 5 חשבוניות, חסר חומר של דלק"
4. **"נקי לסגירה"** → סוגר כל תתי-המשימות → מעביר לענף "מוכן לדיווח מע"מ"

### פתרון 5: Pulse אוטומטי מ-OCR

| מצב | ייצוג ויזואלי | משמעות |
|-----|--------------|--------|
| אין חומר 10+ ימים | צומת שקוף | "אין כאן עבודה, אל תבזבז קשב" |
| חומר חדש הגיע | צומת "נדלק" (solid + הבהוב) | "יש עבודה, כנס ל-2 דקות" |
| נקלט חלקית | כתום מקווקו | "עצרת באמצע, תחזור" |
| הושלם | ירוק מלא | "סיימת, הלאה!" |

### סיכום: מצבי לקוח במפה (כל הצבעים)

| צבע | משמעות |
|-----|--------|
| 🟢 ירוק | סיימת קליטה |
| 🔵 מהבהב | חומר חדש ב-OCR, כנס ל-2 דקות |
| 🟠 כתום מקווקו | התחלת קליטה ועצרת באמצע |
| ⚪ שקוף | אין חומר, תתעלם |
| 🔴 אדום | דדליין עובר! |

---

## חלק ד': מפרט טכני

### ספריות נדרשות

```bash
npm install @xyflow/react
# ReactFlow v12 (חדש, מבוסס @xyflow/react)
# כבר יש בפרויקט: framer-motion, lucide-react, radix-ui
```

### מבנה קבצים

```
src/
├── pages/
│   └── MindMap.jsx                          # עמוד המפה הראשי
│
├── components/
│   └── mindmap/
│       ├── MindMapCanvas.jsx                # ReactFlow canvas wrapper
│       ├── MindMapToolbar.jsx               # סרגל כלים (Focus/Normal/Firefighting/Energy)
│       ├── MindMapInbox.jsx                 # פאנל Inbox צף
│       ├── MindMapDayList.jsx               # פאנל "רשימת היום" צד
│       ├── MindMapBrainDump.jsx             # מצב Brain Dump
│       ├── MindMapEnergySelector.jsx        # בורר "מה מתאים לי עכשיו?" (S/M/L/XL)
│       │
│       ├── nodes/                           # Custom Node Types
│       │   ├── CenterNode.jsx              # הצומת המרכזי "CalmPlan"
│       │   ├── BranchNode.jsx              # ענף ראשי (שכר, מיסים, לקוחות...)
│       │   ├── ServiceNode.jsx             # צומת שירות (מע"מ, שכר, ניכויים...)
│       │   ├── ClientNode.jsx              # צומת לקוח (עלה) - גודל דינמי לפי T-Shirt
│       │   ├── ClientExpandedNode.jsx      # צומת לקוח L/XL מורחב (תת-שלבים)
│       │   ├── DashboardNode.jsx           # צומת לוח מחוונים (deep link)
│       │   ├── TaskNode.jsx                # צומת משימה בודדת
│       │   ├── ClusterNode.jsx             # בועת קיבוץ (10+ לקוחות)
│       │   ├── InboxItemNode.jsx           # פריט ב-Inbox
│       │   ├── AccumulationNode.jsx        # צומת מד-צבירה (קליטת הוצאות)
│       │   ├── CheckpointNode.jsx          # צומת בקרה (עיגול חלול - OCR)
│       │   └── StagingNode.jsx             # צומת סבבים (לקוח גדול - batches)
│       │
│       ├── edges/
│       │   └── StatusEdge.jsx              # קשת עם צבע סטטוס
│       │
│       └── hooks/
│           ├── useMindMapData.js           # מושך Tasks, Clients → יוצר nodes/edges
│           ├── useSemanticZoom.js           # מנהל zoom levels
│           ├── useFocusMode.js             # סינון "מה עכשיו?"
│           ├── useNodeContextMenu.js       # תפריט ימני (כולל context-aware לקליטה)
│           ├── useInbox.js                 # ניהול Inbox state
│           ├── useEnergyFilter.js          # סינון לפי מפלס אנרגיה (T-Shirt)
│           └── useComplexityScoring.js     # חישוב מורכבות לקוח-שירות
│
├── config/
│   ├── mindmapLayout.js                    # הגדרות פריסה, צבעים, מיקומים ראשוניים
│   └── complexityConfig.js                 # הגדרות T-Shirt sizes + energy levels
│
└── utils/
    └── mindmapHelpers.js                   # פונקציות עזר (חישוב סטטוס, בניית עץ)
```

### Data Flow

```
[localStorage/Supabase]
       │
       ▼
[base44 Client] ─── Task.list(), Client.list(), etc.
       │
       ▼
[useMindMapData hook]
       │
       ├── מיפוי Tasks → ServiceNodes + ClientNodes
       ├── מיפוי Clients → ClientNodes
       ├── חישוב סטטוסים → צבעים + גדלים
       └── בניית edges (קשרים)
       │
       ▼
[ReactFlow Canvas]
       │
       ├── Custom Nodes (render)
       ├── Semantic Zoom (filter by zoom level)
       ├── Context Menu (quick actions)
       └── Focus Mode (filter by date)
```

### Custom Node Types

#### CenterNode (מרכז)
```
┌─────────────────────┐
│    🧠 CalmPlan      │
│  ──────────────────  │
│  12 דחוף │ 34 בעבודה│
│  סה"כ: 89 משימות    │
└─────────────────────┘
```

#### BranchNode (ענף ראשי)
```
┌──────────────────┐
│  💰 חשבות שכר    │
│  ═══════════════ │
│  ████████░░ 78%  │  ← מד התקדמות כללי
│  3🔴  5🟡  12🟢  │  ← ספירת סטטוסים
└──────────────────┘
```

#### ServiceNode (שירות)
```
┌─────────────────┐
│  📝 מע"מ        │
│  ──────────────  │
│  8/12 לקוחות ✅  │
│  ████████░░ 67% │
│  2 דדליינים ⚠️   │
└─────────────────┘
```

#### ClientNode (לקוח - עלה) - גודל דינמי לפי T-Shirt
```
 [S] קטן                [M] רגיל              [L] גדול                [XL] מפלצת
┌─────────┐         ┌─────────────┐       ┌──────────────────┐    ┌──────────────────────┐
│○ דני    │         │ ○ אברהם כהן │       │ ○ חברת אלפא ⚡    │    │ ○ חברת מגה ⚡⚡ 🧠     │
│ 5 דק'   │         │ שלב: דיווח  │       │ שלב: בדיקת התאמ' │    │ Deep Work נדרש       │
│          │         │ ████░░ 60%  │       │ ████████░░ 80%   │    │ ████░░░░░░░░ 33%     │
└─────────┘         └─────────────┘       │ ~2 שעות          │    │ ~5 שעות (4 שלבים)   │
 scale: 0.7          scale: 1.0           └──────────────────┘    └──────────────────────┘
                                            scale: 1.4              scale: 1.8
```

#### ClientExpandedNode (L/XL - תת-שלבים)
```
┌─────────────────────────────┐
│ ⚡ חברת מגה [XL]             │
│ ════════════════════════════ │
│ ✅ קליטת חומר (15 דק')       │
│ 🔄 בדיקת התאמות (60 דק')    │
│ ○  הפקה (60 דק')             │
│ ○  בקרה (30 דק')             │
│ ════════════════════════════ │
│ ████████░░░░ 50%             │
└─────────────────────────────┘
```

#### AccumulationNode (מד-צבירה - קליטת הוצאות)
```
┌───────────────────────────┐
│ 📥 קליטת הוצאות - אברהם  │
│                           │
│ [████████░░░░░░░░] 50%    │
│                           │
│ ✅ חומר ב-OCR             │
│ ✅ פוענח                   │
│ ○  נקלט                   │
│ ○  סגור                   │
└───────────────────────────┘
```

#### CheckpointNode (בקרה - OCR)
```
    ╭ ─ ─ ─ ─ ─ ─╮
    ╎  ◌ דני כהן  ╎   ← עיגול חלול (בקרה בלבד)
    ╎  OCR ✓      ╎   ← מהבהב כשיש חומר חדש
    ╰ ─ ─ ─ ─ ─ ─╯
```

#### StagingNode (סבבים - לקוח גדול)
```
┌──────────────────────────┐
│ 📦 קליטה - חברת מגה      │
│ ═════════════════════════ │
│ ✅ סבב א' (תחילת חודש)   │
│ ✅ סבב ב' (אמצע חודש)    │
│ ○  סבב ג' (השלמות)       │
│ 🔒 סגירה לדיווח          │
│ ═════════════════════════ │
│ 2/3 סבבים הושלמו         │
└──────────────────────────┘
```

#### ClusterNode (בועת קיבוץ)
```
    ┌───────┐
    │  23   │  ← מספר לקוחות
    │ לקוח  │
    └───────┘
    (לחיצה מפזרת)
```

---

## חלק ד.2: גאנט ADHD-Friendly (ציר הזמן החכם)

### הבעיה שגאנט פותר
ה-Mind Map עוזר להתמצא ב**מרחב** (איפה הדברים נמצאים).
הגאנט עוזר להתמצא ב**זמן** (מתי הדברים הולכים להתפוצץ).

אבל גאנט קלאסי (פסים אופקיים על ציר זמן) הוא **עומס ויזואלי מעיק** ל-ADHD.
הפתרון: גאנט שמדבר בשפה ויזואלית, לא בטקסט.

### מה כבר קיים
- `ProjectTimelineView.jsx` - גאנט בסיסי עם פסים צבעוניים per task
- `taxCalendar2026.js` - דדליינים חוקיים (15, 19, 23 לחודש)
- Recharts library - גרפים קיימים ב-Analytics

### 1. גאנט "מפלס הלחץ" (Workload Heatmap)

במקום רק פסים של משימות, הגאנט מראה **עומס מצטבר per day**.

```
פברואר 2026
│  1    2    3    4    5    6    7    8    9   10   11   12   13   14   15  │
│  ░░   ░░   ░░   ██   ██   ░░   ░░   ░░   ██   ██   ████ ████ ████ ████ 🔥│
│                                                                     ▲    │
│  רקע: ░ ירוק  ██ צהוב  ████ אדום  🔥 קריטי                    דד-ליין  │
```

**איך זה עובד:**
- רקע כל יום צבוע לפי **סכום דקות עבודה מתוכננות** (מ-T-Shirt sizes)
- ירוק: < 4 שעות | צהוב: 4-6 שעות | אדום: 6-8 שעות | קריטי: 8+ שעות
- **הערך ל-ADHD:** רואים ויזואלית שה-13 "מלא מדי" עוד לפני שהתחלת

### 2. דד-ליין כפול: "מרחק בטיחות" (Buffer View)

שני קווים אנכיים במקום אחד:

```
│                         ↓ דד-ליין פנימי (10)    ↓ דד-ליין חוקי (15)     │
│  ═══════════════════════╪═══════════════════════╪════════════════════    │
│  ████ שכר - אברהם      │▓▓▓▓ שכר - דני        │                       │
│  ██████ מע"מ - שרה     │▓▓▓ מע"מ - יעקב       │                       │
│                         │                       │                       │
│  ████ = בטוח (לפני 10)  ▓▓▓ = אזור סכנה (10-15) │ אחרי 15 = שריפה 🔥  │
```

**הקסם:**
- המשימות נצבעות לפי **המרחק מהקו הכחול (10)**, לא מהאדום (15)
- זה מייצר "דחיפות מלאכותית" שמונעת הגעה לקצה
- **הקונפיג:** `taxCalendar2026.js` כבר מכיל את הדדליינים החוקיים → נוסיף `internalBuffer: 5` (ימים)

### 3. פסים מקוטעים ללקוחות גדולים (Multi-Step Bar)

במקום פס אחד ארוך "מע"מ אברהם (1-15)", מפרקים ל-**מנות**:

```
│  1────5        10──11       14─15                                       │
│  ┌────┐        ┌───┐        ┌──┐                                       │
│  │ S1 │ . . .  │ S2│ . . .  │S3│  ← אברהם (XL) - 3 סבבי קליטה         │
│  └────┘        └───┘        └──┘                                       │
│  S1=קליטה ראשונה  S2=השלמה  S3=סגירה+שידור                             │
│                                                                         │
│  ┌─┐                              ← דני (S) - חטיף אחד                 │
│  └─┘                                                                    │
│  12                                                                     │
```

**הערך ל-ADHD:**
- לא רואים "מע"מ אברהם = 5 שעות" אלא "חצי שעה היום, שעה ביום רביעי"
- הפס המקוטע מראה **איפה אתה עצרת** (S1 ירוק = בוצע, S2 צהוב = עכשיו)

### 4. חצי תחתון: Dependency Arrows

חצים שמראים תלויות בין שלבים:

```
│  קליטת הוצאות ────→ התאמות ────→ הכנת דו"ח ────→ שידור מע"מ           │
│  [✅ בוצע]          [🔄 כעת]     [🔒 נעול]       [🔒 נעול]             │
│                                                                         │
│  ⚠️ החץ מהבהב אם "קליטת הוצאות" מאחרת = הכל עומד להיתקע              │
```

### 5. Smart Zoom לגאנט

| רמת Zoom | מה רואים | שימוש |
|----------|----------|-------|
| **חודשי** | "גושים" של עבודה (שכר בתחילה, מע"מ באמצע) + Heatmap | תכנון כללי |
| **שבועי** | לקוחות ספציפיים + פסים מקוטעים + תלויות | תכנון שבועי |
| **יומי** | שעות ספציפיות per client + T-Shirt size | תכנון יומי |

### 6. סנכרון דו-כיווני: Mind Map ↔ Gantt

```
Mind Map                              Gantt
┌──────────┐    שינוי תאריך →    ┌──────────────┐
│ ○ אברהם  │ ←──────────────────→│ ████ אברהם   │
│ מע"מ 🔴  │    ← שינוי סטטוס    │ 10-12 פבר'   │
└──────────┘                      └──────────────┘
```

| פעולה | מקור | תוצאה |
|-------|------|--------|
| שינוי תאריך בגאנט (גרירת פס) | Gantt | צומת במפה משנה צבע (הפך ליום אחר) |
| שינוי סטטוס במפה | Mind Map | פס בגאנט משנה צבע (ירוק/צהוב/אדום) |
| הוספת לקוח במפה | Mind Map | פס חדש בגאנט בתאריך ברירת מחדל של השירות |
| גרירת לקוח בגאנט ליום אחר | Gantt | deadline של Task מתעדכן ב-DB |

**הערה טכנית:** שניהם קוראים מאותו DB (Tasks, Clients) = סנכרון אוטומטי

### 7. מערכת התראות חכמה (Collision Alerts)

הגאנט מזהה "התנגשויות" ומתריע:

| סוג התראה | תנאי | הודעה | דחיפות |
|-----------|-------|-------|--------|
| **עומס יתר** | סה"כ דקות ביום > 480 (8 שעות) | "ביום X יש לך 10 שעות עבודה. רוצה להזיז משהו?" | 🔴 |
| **התנגשות כבדים** | 3+ לקוחות L/XL באותו יום | "3 לקוחות כבדים ביום אחד = שחיקה. רוצה לפזר?" | 🔴 |
| **שחיקה מנטלית** | 3+ לקוחות `mentalLoad: high` באותו יום | "3 לקוחות מנטליים כבדים. שים אחד ליום אחר" | 🟡 |
| **דדליין קרב** | פחות מ-3 ימים לדדליין פנימי + משימות פתוחות | "דדליין פנימי בעוד 3 ימים, נותרו 4 לקוחות" | 🟡 |
| **חלון הזדמנות** | יום רגוע + עומס בעוד 3 ימים | "היום שקט, רוצה להקדים לקוח מעומס יום חמישי?" | 🟢 |
| **תלות חסומה** | שלב נעול כי שלב קודם לא הושלם | "לא ניתן לשדר מע"מ של אברהם - חסרה קליטה" | 🔴 |
| **Batch מפגר** | סבב קליטה לא הושלם בזמן | "סבב ב' של חברת מגה לא הושלם. הדד-ליין בעוד 4 ימים" | 🟡 |

**התראות מופיעות ב-3 מקומות:**
1. **בגאנט:** באנר צף מעל ציר הזמן
2. **במפה:** צומת מהבהב
3. **בדף הבית (Home):** בקטע "דחופים"

### 8. תצוגת "בוקר" (Morning Briefing)

כשנפתח הגאנט, במקום להציג את כל החודש, מוצגת **תצוגת 3 ימים**:

```
┌──────────────────────────────────────────────────────────┐
│  📊 הבוקר שלך - 19 בפברואר                              │
│                                                          │
│  היום              │ מחר                │ מחרתיים         │
│  ████████ 6.5 שעות │ ██████ 4 שעות      │ ████ 3 שעות     │
│                    │                    │                  │
│  🔴 שכר דני (L)    │ ○ מע"מ שרה (M)    │ ○ ניכויים (S)    │
│  🟡 שכר יעקב (M)  │ ○ מע"מ יעקב (S)   │ ○ ייעוץ (S)      │
│  ○ ניכויים (S×3)  │ ○ התאמות (M)       │                  │
│                    │                    │                  │
│  ⚠️ היום עמוס!     │ 💡 "רוצה להזיז    │ ✨ יום קל!        │
│  שקול להזיז       │  ניכויים לפה?"     │                  │
└──────────────────────────────────────────────────────────┘
```

### 9. משולש העבודה (The Work Triangle)

3 תצוגות שמשלימות זו את זו:

```
        Mind Map (מרחב)
       "איפה הדברים?"
            /\
           /  \
          /    \
         /      \
        /        \
       /          \
      /            \
     /______________\
Kanban (סטטוס)    Gantt (זמן)
"מה הסטטוס?"     "מתי זה קורה?"
```

| תצוגה | שאלה מרכזית | מתי משתמשים |
|-------|-------------|-------------|
| **Mind Map** | "מה יש לנו? איפה כל דבר? מה הקשר?" | תכנון, ניווט, סקירה כללית |
| **Kanban** | "מה בטיפול? מה חסום? מה הסטטוס?" | ביצוע יומי (כבר קיים בלוחות) |
| **Gantt** | "מתי? כמה זמן? מה מתקרב? מה מתנגש?" | תכנון זמן, מניעת שריפות |

**מעבר בין תצוגות:**
- כפתור toggle ב-Toolbar: 🗺️ מפה | 📋 קנבן | 📊 ציר זמן
- או: Split View - מפה למעלה, גאנט למטה (50/50)

### 10. מפרט טכני - קומפוננטות גאנט

```
src/
├── components/
│   └── gantt/
│       ├── GanttView.jsx                    # קומפוננטה ראשית
│       ├── GanttTimeline.jsx                # ציר הזמן (ימים/שבועות/חודש)
│       ├── GanttBar.jsx                     # פס משימה (כולל מקוטע ל-batches)
│       ├── GanttHeatmap.jsx                 # שכבת Heatmap (עומס per day)
│       ├── GanttDeadlines.jsx               # קווי דדליין (פנימי + חוקי)
│       ├── GanttDependencies.jsx            # חצי תלויות (dependency arrows)
│       ├── GanttAlerts.jsx                  # באנר התראות (collision alerts)
│       ├── GanttMorningBriefing.jsx         # תצוגת "בוקר" (3 ימים)
│       ├── GanttToolbar.jsx                 # בורר zoom + מצבי תצוגה
│       │
│       └── hooks/
│           ├── useGanttData.js              # מושך Tasks → פסים + תלויות
│           ├── useWorkloadCalculation.js     # חישוב עומס per day (מ-T-Shirt)
│           ├── useDeadlineBuffer.js          # חישוב דדליין פנימי
│           ├── useCollisionDetection.js      # זיהוי התנגשויות + התראות
│           └── useGanttDragDrop.js           # גרירת פסים לשינוי תאריכים
│
├── pages/
│   └── GanttTimeline.jsx                    # עמוד הגאנט (standalone)
│
└── config/
    └── ganttConfig.js                       # הגדרות: buffer days, workload thresholds, colors
```

### 11. שילוב עם taxCalendar2026.js

הגאנט מושך את הדדליינים החוקיים מ-`taxCalendar2026.js`:

```javascript
// ganttConfig.js
export const GANTT_CONFIG = {
  // Buffer days before legal deadline
  internalBufferDays: 5,

  // Workload thresholds (minutes per day)
  workloadThresholds: {
    light: 240,    // < 4 hours = green
    normal: 360,   // 4-6 hours = yellow
    heavy: 480,    // 6-8 hours = red
    critical: 540, // 8+ hours = fire
  },

  // Collision rules
  collisionRules: {
    maxLargeClientsPerDay: 2,      // max L/XL per day
    maxHighMentalLoadPerDay: 2,    // max mentalLoad=high per day
    earlyWarningDays: 3,           // days before deadline to alert
  },

  // Zoom levels
  zoomLevels: {
    monthly: { dayWidth: 30, showClients: false },
    weekly: { dayWidth: 80, showClients: true },
    daily: { dayWidth: 200, showClients: true, showHours: true },
  },
};
```

---

## חלק ה': שלבי יישום

### שלב 1: שלד המפה + T-Shirt Sizing (Sprint 1 - ~25 שעות עבודה)

#### 1.1 תשתית בסיסית
- [ ] התקנת `@xyflow/react`
- [ ] יצירת עמוד `MindMap.jsx` + הוספה ל-routes
- [ ] הוספת "מפת פיקוד" לתפריט הניווט (Layout.jsx)
- [ ] יצירת `MindMapCanvas.jsx` עם ReactFlow בסיסי
- [ ] יצירת `complexityConfig.js` עם הגדרות T-Shirt (S/M/L/XL)

#### 1.2 Custom Nodes בסיסיים
- [ ] `CenterNode` - הצומת המרכזי
- [ ] `BranchNode` - 9 ענפים ראשיים (ראה מבנה מעלה)
- [ ] `DashboardNode` - צמתים עם Deep Link לכל 30+ עמודים קיימים
- [ ] `ServiceNode` - צמתי שירותים (מ-processTemplates.js)
- [ ] `ClientNode` - עם גודל דינמי לפי complexity (S/M/L/XL)

#### 1.3 Data Hook בסיסי
- [ ] `useMindMapData.js` - מושך Tasks + Clients ובונה nodes/edges
- [ ] מיפוי `ALL_SERVICES` מ-processTemplates → ServiceNodes
- [ ] מיפוי navigationGroups מ-Layout → DashboardNodes
- [ ] חישוב סטטוס צבעוני per node
- [ ] `useComplexityScoring.js` - חישוב T-Shirt size per client-service

#### 1.4 Toolbar + מצבי תצוגה
- [ ] `MindMapToolbar.jsx` עם 4 כפתורים: רגיל / Focus / Firefighting / Energy
- [ ] Focus Mode: מסנן לפי deadline = היום/שבוע
- [ ] Firefighting: מציג רק אדומים (status = issue / overdue)
- [ ] `MindMapEnergySelector.jsx` - "מה מתאים לי עכשיו?" (אנרגיה נמוכה/רגילה/Deep Work)

**תוצר:** מפה סטטית עם כל הענפים, צבעי סטטוס, deep links, T-Shirt sizes, ו-Energy Matching

---

### שלב 2: אינטראקטיביות + מורכבות (Sprint 2 - ~25 שעות)

#### 2.1 Semantic Zoom
- [ ] `useSemanticZoom.js` - מזהה zoom level ומסנן nodes
- [ ] Zoom Out: רק ענפים ראשיים
- [ ] Mid Zoom: ענפים + שירותים + אינדיקטורים
- [ ] Zoom In: לקוחות כעלים (גודל לפי T-Shirt)

#### 2.2 Context Menu (תפריט ימני)
- [ ] `useNodeContextMenu.js` - Radix ContextMenu
- [ ] שינוי סטטוס מהיר (dropdown)
- [ ] "פתח כרטיס מלא" (Deep Link)
- [ ] "הגדר כחוזרת" (מיני-טופס → RecurringTasks)
- [ ] "העבר ל-Inbox"
- [ ] "צפה במסמכים" (Drawer + FileMetadata)
- [ ] **"כמה זמן יש לי?"** - סינון לפי 15 דק' / שעה / Deep Work (על ענף ראשי)

#### 2.3 ClientNode מתקדם + T-Shirt
- [ ] `ClientNode.jsx` עם הילת סטטוס (halo)
- [ ] **גודל דינמי**: S=0.7x, M=1.0x, L=1.4x, XL=1.8x
- [ ] Pulse animation לדדליינים קרובים
- [ ] **אייקון 🧠** ללקוחות עם `mentalLoad: "high"`
- [ ] `ClientExpandedNode.jsx` - צומת מתרחב ל-L/XL עם תת-שלבים

#### 2.4 Clustering
- [ ] `ClusterNode.jsx` - בועה עם ספירה
- [ ] לחיצה על בועה = מפזרת לקוחות סביבה
- [ ] אוטומטי כשיש 10+ לקוחות בענף

#### 2.5 Energy Filter
- [ ] `useEnergyFilter.js` - סינון לפי מפלס אנרגיה
- [ ] אנרגיה נמוכה: רק S מוצג, שאר מעומעמים
- [ ] אנרגיה רגילה: S + M מוצגים
- [ ] Deep Work: לקוח L/XL אחד בלבד + Calm Down אוטומטי
- [ ] **אזהרת שחיקה**: "3 לקוחות כבדים מנטלית היום - בטוח?"

**תוצר:** מפה אינטראקטיבית עם zoom, context menu, T-Shirt sizing, Energy Matching

---

### שלב 3: Inbox + Brain Dump + תהליכי קליטה (Sprint 3 - ~25 שעות)

#### 3.1 Inbox צף
- [ ] `MindMapInbox.jsx` - פאנל צד שתמיד פתוח
- [ ] קיצור מקלדת (Ctrl+I) לזריקת פריט
- [ ] גרירת פריט מ-Inbox לענף במפה → יצירת Task
- [ ] בסוף יום: "יש 3 פריטים ב-Inbox, לאן לשבץ?"

#### 3.2 Brain Dump
- [ ] `MindMapBrainDump.jsx` - מצב הקלדה מהירה
- [ ] Enter אחרי כל שורה = צומת זמני צף
- [ ] גרירת צמתים זמניים לענפים → יצירת Tasks

#### 3.3 רשימת היום
- [ ] `MindMapDayList.jsx` - פאנל צד ליניארי
- [ ] כפתור "רשימת היום" → מציג כל הצמתים האדומים/צהובים כרשימה
- [ ] **מיון לפי T-Shirt**: חטיפים (S) למעלה, כבדים (L/XL) למטה
- [ ] Checkbox לסימון השלמה (מעדכן DB)

#### 3.4 תהליכי קליטה דינמיים (Batch Work)
- [ ] `AccumulationNode.jsx` - צומת מד-צבירה (סוללה 4 שלבים)
- [ ] `CheckpointNode.jsx` - צומת בקרה (OCR) - עיגול חלול מהבהב
- [ ] `StagingNode.jsx` - תצוגת סבבים ללקוחות גדולים
- [ ] **הבחנה "ביצוע" vs "בקרה"**: סוג צומת שונה per client type
- [ ] **תפריט ימני ייעודי לקליטה**: פתח OCR / סמן כנקלט חלקית / דרישת חומר / נקי לסגירה
- [ ] **Pulse אוטומטי**: שקוף (אין חומר) → מהבהב (חומר חדש) → כתום (חלקי) → ירוק (סגור)

#### 3.5 Show on Map
- [ ] הוספת כפתור "הצג במפה" בכל עמוד קיים
- [ ] לחיצה → ניווט ל-/MindMap עם query param → center + zoom על הצומת

**תוצר:** מפה עם Inbox, Brain Dump, רשימת יום, תהליכי קליטה חכמים, ניווט דו-כיווני

---

### שלב 4: Gantt ADHD-Friendly (Sprint 4 - ~25 שעות)

#### 4.1 שלד הגאנט
- [ ] יצירת עמוד `GanttTimeline.jsx` + הוספה ל-routes
- [ ] `GanttView.jsx` - קומפוננטה ראשית עם Recharts
- [ ] `GanttTimeline.jsx` - ציר זמן (ימים/שבועות/חודש)
- [ ] `GanttBar.jsx` - פסי משימות (כולל מקוטע ל-batches)
- [ ] `GanttToolbar.jsx` - בורר zoom (חודשי/שבועי/יומי)
- [ ] `ganttConfig.js` - הגדרות buffer, thresholds, colors

#### 4.2 Heatmap + Deadlines
- [ ] `GanttHeatmap.jsx` - שכבת עומס per day (ירוק→צהוב→אדום→קריטי)
- [ ] `useWorkloadCalculation.js` - חישוב דקות per day מ-T-Shirt sizes
- [ ] `GanttDeadlines.jsx` - קווי דדליין כפולים (פנימי + חוקי)
- [ ] `useDeadlineBuffer.js` - חישוב buffer מ-taxCalendar2026

#### 4.3 תלויות + Multi-Step Bars
- [ ] `GanttDependencies.jsx` - חצי תלויות בין שלבים
- [ ] פסים מקוטעים ל-L/XL clients (סבבי קליטה)
- [ ] הבהוב חץ כשתלות חסומה

#### 4.4 התראות חכמות (Collision Alerts)
- [ ] `useCollisionDetection.js` - זיהוי התנגשויות
- [ ] `GanttAlerts.jsx` - באנר צף עם סוגי התראות
- [ ] "חלון הזדמנות" - הצעה להקדמת עבודה מיום עמוס

#### 4.5 Morning Briefing + סנכרון
- [ ] `GanttMorningBriefing.jsx` - תצוגת 3 ימים ברירת מחדל
- [ ] `useGanttDragDrop.js` - גרירת פסים לשינוי תאריכים
- [ ] סנכרון דו-כיווני Mind Map ↔ Gantt (אותו DB)
- [ ] Toggle button: 🗺️ מפה | 📋 קנבן | 📊 ציר זמן

**תוצר:** גאנט ADHD-friendly עם heatmap, buffer deadlines, collision alerts, ו-morning briefing

---

### שלב 5: שיפורים מתקדמים (Sprint 5 - ~20 שעות)

#### 5.1 Calm Down Mode
- [ ] כפתור "Calm Down" → מסתיר הכל חוץ מענף נוכחי
- [ ] טיימר Pomodoro מובנה (25 דקות)
- [ ] צליל/ויברציה בסיום

#### 5.2 Cross-Linking
- [ ] זיהוי לקוחות שמופיעים ביותר משירות אחד
- [ ] בכניסה לצומת לקוח: "גם פתוח אצלו: מע"מ, שכר"
- [ ] כפתור מעבר מהיר בין שירותים של אותו לקוח

#### 5.3 Context Memory
- [ ] שמירת "פעולה אחרונה" per client per service
- [ ] פתק דביק מיני בכניסה לצומת: "עצרת ב: הכנת דו"ח מע"מ (לפני 3 ימים)"
- [ ] שמירה ב-localStorage

#### 5.4 Dopamine Progress
- [ ] ענף "בוצע היום" שגדל
- [ ] אנימציית "עף לענף" בהשלמת משימה
- [ ] סטטיסטיקות יומיות (כמה הושלם)

#### 5.5 פידבק מורכבות (Self-Learning)
- [ ] אחרי השלמת משימה: "איך הרגשת?" (קל/ממוצע/מעמיס)
- [ ] עדכון אוטומטי של `mentalLoad` לפי פידבק
- [ ] שיפור הערכות T-Shirt לאורך זמן

---

## חלק ו': שדרוג כל הלוחות הקיימים (ADHD-Friendly Overhaul)

### הבעיה הכללית
הלוחות הקיימים מעולים לניהול נתונים, אבל הם עדיין דורשים מהמשתמש "לנהל אותם".
השדרוגים הבאים הופכים את הלוחות לכאלה ש**מנהלים אותך** - צועקים בצבעים, מקצרים תהליכים, ולא נותנים ללכת לאיבוד בטבלאות.

---

### שדרוג 1: לוחות ריכוז/טבלאות - "פחות טבלה, יותר סוללה"

**חל על:** PayrollDashboard, TaxReportsDashboard, ClientsDashboard, AdditionalServicesDashboard, PeriodicSummaryReports

#### הבעיה
טבלאות עמוסות עם צ'קבוקסים קטנים שכולם נראים אותו דבר = רעש ויזואלי.
ADHD צריך לאמץ עיניים כדי להבין איפה דוד ואיפה אברהם.

#### הפתרון

**א. החלפת צ'קבוקסים ב-Progress Bar:**

```
לפני (טבלה קיימת):
│ לקוח          │ קליטה │ הכנה │ דיווח │ תשלום │
│ א.מ לוג שרמן │  ☑    │  ☑   │  ☐   │  ☐   │  ← קשה להבין ב-glance
│ דני כהן       │  ☑    │  ☑   │  ☑   │  ☐   │

אחרי (שדרוג):
│ לקוח              │ מורכבות │ התקדמות           │ סטטוס           │
│ א.מ לוג שרמן 🧠  │ [XL]    │ ████████░░░░ 50%  │ 🟡 הכנת דו"ח   │  ← מובן מיידית
│ דני כהן           │ [S]     │ ████████████░ 75% │ 🟢 ממתין תשלום  │
```

**ב. אינדיקטור T-Shirt ליד שם הלקוח:**
- `[S]` = שורה רגילה, רקע לבן
- `[M]` = שורה רגילה, רקע לבן
- `[L]` = שורה **עבה יותר** (padding גדול), רקע cream
- `[XL]` = שורה **עבה ומודגשת**, רקע צהוב בהיר, מסגרת שמאלית צבעונית
- `🧠` = אייקון מנטלי כבד (מופיע ליד שם)

**ג. Progress Bar עם צבעי שלבים:**
```css
/* כל שלב שהושלם = חלק ירוק בסוללה */
/* שלב נוכחי = צהוב/כתום */
/* שלבים שנותרו = אפור */
```

#### קבצים שמושפעים:
- `src/components/dashboards/` - כל קומפוננטות הטבלה
- `src/pages/PayrollDashboard.jsx`
- `src/pages/TaxReportsDashboard.jsx`
- `src/pages/ClientsDashboard.jsx`
- `src/pages/AdditionalServicesDashboard.jsx`
- `src/pages/PeriodicSummaryReports.jsx`

---

### שדרוג 2: לוחות קנבן - "מניעת עיוורון צבעים קוגניטיבי"

**חל על:** Tasks (Kanban view), AdminTasksDashboard, כל תצוגת Kanban בפרויקט

#### הבעיה
כל הכרטיסיות נראות כמעט אותו דבר. כשהכל כתום-דחוף = שום דבר לא באמת דחוף.

#### הפתרון

**א. קידוד צבעים לפי סוג לחץ (לא רק סטטוס):**

| סוג לחץ | צבע רקע כרטיסייה | אייקון | משמעות |
|----------|------------------|--------|--------|
| חסר חומר | 🔵 כחול בהיר | ⏳ | ממתין - לא תלוי בך |
| חייב להסתיים היום | 🔴 אדום | 🔥 | פעולה נדרשת עכשיו |
| שגרתי - לא דחוף | ⚪ לבן/אפור | ○ | עבודה רגילה |
| הושלם | 🟢 ירוק | ✅ | סיימת! |
| חסום (תלות) | 🟣 סגול | 🔒 | לא ניתן להתקדם |

**ב. גודל כרטיסייה לפי T-Shirt:**
- `[S]` = כרטיסייה קומפקטית (שורה אחת)
- `[M]` = כרטיסייה רגילה
- `[L]` = כרטיסייה גדולה עם Progress Bar מובנה
- `[XL]` = כרטיסייה עם תת-שלבים מפורקים (expandable)

**ג. Quick Wins למעלה:**
- סידור אוטומטי: כרטיסיות `[S]` תמיד למעלה (חטיפים = ניצחונות מהירים)
- כרטיסיות `[L/XL]` בתחתית (דורשות Deep Work)

#### קבצים שמושפעים:
- `src/components/tasks/KanbanView.jsx`
- `src/components/tasks/TaskCard.jsx`
- `src/pages/Tasks.jsx`
- `src/pages/AdminTasksDashboard.jsx`

---

### שדרוג 3: דשבורד עליון (סטטיסטיקות) - "מסטטיסטיקה לפעולה"

**חל על:** Home, ClientsDashboard, PayrollDashboard, TaxReportsDashboard (כל עמוד עם summary cards)

#### הבעיה
אחוזים (43%, 47%) הם אבסטרקטיים. ADHD לא יודע לתרגם "43%" לפעולה ב-10 בבוקר.

#### הפתרון

**א. קוביות סטטיסטיקה הופכות ל-Quick Filters:**

```
┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│  17 סה"כ     │  │  8 הושלמו ✅  │  │  5 בעבודה 🔄 │  │  4 דחוף 🔥   │
│  ──────────  │  │  ──────────  │  │  ──────────  │  │  ──────────  │
│  לחץ לסינון  │  │  לחץ לדופמין │  │  לחץ לרשימה  │  │  לחץ לשריפות│
└──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘
       ↓                 ↓                 ↓                 ↓
   פתח Mind Map    הסתר הכל,         סנן טבלה         סנן רק אדומים
                   הראה רק ירוקים    לבעבודה בלבד
```

**ב. לחיצה על "סה"כ" = פתח Mind Map ברלוונטי:**
- קובייה "17 סה"כ דיווחי מע"מ" → פתח Mind Map ממורכז על ענף "מיסים → מע"מ"
- קובייה "4 דחוף" → פתח Mind Map במצב Firefighting

**ג. מיקרו-אנימציה:**
- כשמשימה מושלמת, המספר ב"הושלמו" עולה ב-+1 עם אנימציה (dopamine hit)

#### קבצים שמושפעים:
- `src/pages/Home.jsx` (summary cards)
- `src/pages/PayrollDashboard.jsx` (header stats)
- `src/pages/TaxReportsDashboard.jsx` (header stats)
- `src/pages/ClientsDashboard.jsx` (header stats)
- כל דף עם `<Card>` סטטיסטי

---

### שדרוג 4: Sidebar (תפריט ניווט) - "מצבי עבודה"

**חל על:** Layout.jsx (navigationGroups)

#### הבעיה
תפריט עם 20+ אפשרויות = Decision Fatigue. המוח מתעייף עוד לפני שהתחיל.

#### הפתרון

**א. 4 מצבי עבודה (Work Modes):**

| מצב | מה מוצג | מתי |
|-----|---------|-----|
| 🌅 **בוקר** | פוקוס יומי + לוח שנה + דחופים | ברירת מחדל 7:00-9:00 |
| ⚡ **ביצוע** | קנבן + לוח ריכוז הרלוונטי | ברירת מחדל 9:00-17:00 |
| 📋 **אדמין** | מרכז לקוחות + ספקים + שכ"ט + קבצים | לפי בחירה |
| 🗺️ **תכנון** | Mind Map + Gantt + תכנון שבועי + אנליטיקס | לפי בחירה |

**ב. מימוש:**
```jsx
// Layout.jsx
const [workMode, setWorkMode] = useState('auto'); // auto = לפי שעה

const filteredNavigation = useMemo(() => {
  if (workMode === 'morning') return navigationGroups.filter(/*...*/);
  if (workMode === 'execution') return navigationGroups.filter(/*...*/);
  // ...
}, [workMode]);
```

**ג. בורר מצב ב-Sidebar Header:**
```
┌──────────────────────┐
│ 🧠 LitayCalmPlan      │
│ ──────────────────── │
│ [🌅] [⚡] [📋] [🗺️]   │  ← בורר מצב (4 כפתורים)
│ ──────────────────── │
│  🔍 חיפוש...          │
└──────────────────────┘
```

**ד. Auto Mode:** לפי שעה ביום, הסייד-בר משנה את עצמו אוטומטית:
- 7:00-9:00 = מצב בוקר
- 9:00-17:00 = מצב ביצוע
- שאר הזמן = מלא

#### קבצים שמושפעים:
- `src/pages/Layout.jsx`

---

### שדרוג 5: לוח לקוחות - "מסטטי לדינמי"

**חל על:** ClientManagement, ClientsDashboard, ClientOnboarding

#### הפתרון

**א. כרטיס לקוח מורחב:**
```
┌──────────────────────────────────────┐
│ אברהם כהן [L] 🧠                    │
│ ═══════════════════════════════════  │
│ שכר: ████████░░ 80%  │ מע"מ: ████░░ 40% │
│ ──────────────────────────────────── │
│ 📋 3 משימות פתוחות │ ⏰ דדליין: 3 ימים │
│ 💬 "עצרתי ב: הכנת תלושים"          │
│ ──────────────────────────────────── │
│ [פתח כרטיס] [הצג במפה] [Gantt]     │
└──────────────────────────────────────┘
```

**ב. סינון לפי T-Shirt:**
- כפתור "הראה רק חטיפים [S]" = Quick Wins
- כפתור "הראה רק מפלצות [XL]" = Deep Work

**ג. קיבוץ חכם (Smart Grouping):**
- אוטומטי: "לקוחות שחסר להם חומר" | "לקוחות מוכנים לדיווח" | "לקוחות בעייתיים"
- ידני: תגיות שהמשתמש יוצר (זהב, בעייתי, עונתי)

#### קבצים שמושפעים:
- `src/pages/ClientManagement.jsx`
- `src/components/clients/` - כל קומפוננטות הלקוחות

---

### שדרוג 6: לוחות תכנון - "מתכנון לפעולה"

**חל על:** WeeklyPlanningDashboard, WeeklySummary, Calendar

#### הפתרון

**א. תכנון שבועי + T-Shirt Budget:**
```
┌──────────────────────────────────────────┐
│ תכנון שבוע 8 (16-20 פברואר)              │
│ ═══════════════════════════════════════  │
│ תקציב שבועי: 40 שעות                    │
│ ████████████████████████░░░░ 65% (26/40) │
│                                          │
│ ראשון: ██████ 7h   (2L + 3S)            │
│ שני:   ████ 5h     (1L + 2M)            │
│ שלישי: ██████ 6h   (3M + 4S)            │
│ רביעי: ████████ 8h (1XL + 1M) ⚠️ עמוס!  │
│ חמישי: 0h           ← פנוי               │
│                                          │
│ 💡 "רביעי עמוס. רוצה להזיז M לחמישי?"   │
└──────────────────────────────────────────┘
```

**ב. סיכום שבועי + Dopamine:**
- ספירת "ניצחונות" (משימות שהושלמו) עם אנימציה
- השוואה לשבוע קודם: "השבוע סיימת 23 משימות = +5 מהשבוע שעבר!"

#### קבצים שמושפעים:
- `src/pages/WeeklyPlanningDashboard.jsx`
- `src/pages/WeeklySummary.jsx`
- `src/pages/Calendar.jsx`

---

### שדרוג 7: לוחות אוטומציה - "חכם יותר"

**חל על:** AutomationRules, RecurringTasks

#### הפתרון

**א. Automation + T-Shirt:**
- כשנוצרת משימה אוטומטית, היא יורשת את ה-T-Shirt size מהלקוח
- כלל חדש: "אל תתזמן 2 משימות XL לאותו יום" (מונע עומס אוטומטי)

**ב. RecurringTasks + Batch Support:**
- משימה חוזרת יכולה להגדיר "כמה סבבים בחודש" (לקוחות גדולים)
- המערכת מפזרת את הסבבים אוטומטית על פני החודש

#### קבצים שמושפעים:
- `src/pages/AutomationRules.jsx`
- `src/pages/RecurringTasks.jsx`

---

### שדרוג 8: לוחות כספיים - "ממספרים לפעולה"

**חל על:** FeeManagement, Reconciliations, BalanceSheets

#### הפתרון

**א. FeeManagement + התראות:**
- אינדיקטור ויזואלי "לא שולם X חודשים" (אדום מהבהב)
- Quick Action: "שלח תזכורת" ישירות מהטבלה

**ב. Reconciliations + Progress:**
- Progress Bar per client (כמה חודשים הותאמו מתוך השנה)
- סימון ויזואלי "הפרש שלא נפתר" (כתום)

**ג. BalanceSheets + Timeline:**
- ציר זמן "איפה כל לקוח בתהליך המאזן" (איסוף → הכנה → בדיקה → הגשה)

#### קבצים שמושפעים:
- `src/pages/FeeManagement.jsx`
- `src/pages/Reconciliations.jsx`
- `src/pages/BalanceSheets.jsx`

---

### שדרוג 9: דף בית (Home) - "מנהל אותך"

**חל על:** Home

#### הפתרון

**א. Morning Briefing מובנה:**
```
┌──────────────────────────────────────┐
│ 🌅 בוקר טוב! 19 בפברואר             │
│ ════════════════════════════════════ │
│                                      │
│ 📊 היום: 6 משימות (3S + 2M + 1L)    │
│ ████████░░░░ ~5.5 שעות               │
│                                      │
│ 🔥 דחוף: שכר דני (L) - דדליין היום   │
│ 💡 Quick Win: 3 ניכויים (S) ← 15 דק' │
│ ⚠️ מחר עמוס: 8 שעות מתוכננות        │
│                                      │
│ [התחל עם חטיפים] [Deep Work: דני]    │
└──────────────────────────────────────┘
```

**ב. כפתורי הפעלה ישירים:**
- "התחל עם חטיפים" = פותח רשימת S בלבד
- "Deep Work" = בוחר לקוח L/XL אחד + Calm Down mode
- "הצג במפה" = פותח Mind Map

#### קבצים שמושפעים:
- `src/pages/Home.jsx`
- `src/components/home/`

---

### שלב יישום שדרוגי לוחות (Sprint 6 - ~25 שעות)

#### 6.1 Progress Bars לטבלאות
- [ ] קומפוננטת `ClientProgressBar.jsx` - מחליפה צ'קבוקסים
- [ ] אינדיקטור T-Shirt `ComplexityBadge.jsx` ([S] [M] [L] [XL])
- [ ] שילוב ב-PayrollDashboard, TaxReportsDashboard, ClientsDashboard
- [ ] שילוב ב-AdditionalServicesDashboard, PeriodicSummaryReports

#### 6.2 Kanban צבעוני
- [ ] עדכון `TaskCard.jsx` - צבע לפי סוג לחץ (לא רק סטטוס)
- [ ] גודל כרטיסייה דינמי לפי T-Shirt
- [ ] סידור אוטומטי: S למעלה, L/XL למטה
- [ ] שילוב ב-Tasks, AdminTasksDashboard

#### 6.3 Summary Cards כ-Quick Filters
- [ ] הפיכת קוביות סטטיסטיקה ללחיצות (clickable)
- [ ] לחיצה = סינון/מעבר ל-Mind Map
- [ ] אנימציית +1 בהשלמת משימה
- [ ] שילוב ב-Home, PayrollDashboard, TaxReportsDashboard, ClientsDashboard

#### 6.4 Work Modes ל-Sidebar
- [ ] 4 מצבי עבודה ב-Layout.jsx (בוקר/ביצוע/אדמין/תכנון)
- [ ] Auto Mode לפי שעה ביום
- [ ] בורר מצב ב-Sidebar Header

#### 6.5 שדרוגי דף בית + תכנון
- [ ] Morning Briefing ב-Home.jsx
- [ ] T-Shirt Budget ב-WeeklyPlanningDashboard
- [ ] Dopamine counter ב-WeeklySummary
- [ ] כפתורי "התחל עם חטיפים" / "Deep Work"

#### 6.6 שדרוגי לוחות כספיים + לקוחות
- [ ] Progress Bars ב-Reconciliations, BalanceSheets
- [ ] התראת תשלום ב-FeeManagement
- [ ] כרטיס לקוח מורחב עם T-Shirt ב-ClientManagement
- [ ] סינון T-Shirt + Smart Grouping

---

## חלק ח': אינטגרציה עם מערכת קיימת

### entities שנקראים (קריאה בלבד)
| Entity | שימוש במפה |
|--------|-----------|
| `Task` | צמתי משימות, סטטוסים, דדליינים, process_steps |
| `Client` | צמתי לקוחות, שמות, קטגוריות, שירותים |
| `Event` | אירועים בלוח שנה |
| `Lead` | צמתים בענף "לידים" |
| `FileMetadata` | תצוגת קבצים ב-context menu |
| `Invoice` | מעקב תשלומים בצומת לקוח |

### entities שנכתבים (עדכון)
| Entity | פעולה מהמפה |
|--------|------------|
| `Task` | שינוי סטטוס, יצירת משימה חדשה (Brain Dump), עדכון process_steps |
| `Task` (חדש) | שדות: `complexity` (S/M/L/XL), `mental_load`, `batch_round` |
| `StickyNote` | יצירת פתק מ-Inbox |
| `RecurringTasks` | הגדרת משימה חוזרת מ-context menu |
| `Client` (הרחבה) | שדה `service_complexity` per service (T-Shirt), `mental_load_score` |

### config שנקרא
| Config | שימוש |
|--------|-------|
| `processTemplates.js` | `ALL_SERVICES` → ServiceNodes + שלבי תהליך + Accumulation steps |
| `processTemplates.js` | `STATUS_CONFIG` → צבעי הילה |
| `Layout.jsx` | `navigationGroups` → מבנה ענפים + deep links |
| `complexityConfig.js` (חדש) | T-Shirt definitions, Energy levels, Mental load thresholds |

### שדות DB חדשים (schema extensions)

#### Client entity - שדות חדשים:
```javascript
{
  // ... שדות קיימים ...
  service_complexity: {
    payroll: { size: "L", estimatedMinutes: 120, mentalLoad: "high" },
    vat: { size: "M", estimatedMinutes: 45, mentalLoad: "low" },
    // ... per service
  },
  client_type: "do" | "check",    // ביצוע או בקרה (OCR)
  ocr_integration: true | false,   // האם מחובר ל-OCR
}
```

#### Task entity - שדות חדשים:
```javascript
{
  // ... שדות קיימים ...
  complexity: "S" | "M" | "L" | "XL",  // מורכבות (מחושב/ידני)
  mental_load_feedback: null,            // פידבק מהביצוע: "easy" | "medium" | "heavy"
  batch_round: null,                     // מספר סבב (1, 2, 3...) ללקוחות גדולים
  batch_total: null,                     // סה"כ סבבים צפויים
  intake_status: null,                   // "ocr_received" | "decoded" | "entered" | "closed"
  last_action_context: null,             // "איפה עצרתי?" - טקסט חופשי
}
```

---

## חלק ט': סיכום לביצוע

### סדר עדיפויות מוחלט

| # | משימה | שלב | תלות | סוג |
|---|--------|------|-------|-----|
| **Sprint 1: שלד המפה + T-Shirt** | | | | |
| 1 | התקנת @xyflow/react | 1.1 | - | |
| 2 | MindMap page + route | 1.1 | #1 | |
| 3 | complexityConfig.js (T-Shirt sizes) | 1.1 | - | **חדש** |
| 4 | CenterNode + BranchNodes | 1.2 | #2 | |
| 5 | useMindMapData hook | 1.3 | #4 | |
| 6 | DashboardNodes (deep links ל-30+ עמודים) | 1.2 | #5 | |
| 7 | ServiceNodes מ-processTemplates | 1.2 | #5 | |
| 8 | ClientNode עם T-Shirt sizing | 1.2 | #5, #3 | **חדש** |
| 9 | useComplexityScoring hook | 1.3 | #3 | **חדש** |
| 10 | סטטוסים צבעוניים (halo) | 1.3 | #7 | |
| 11 | Toolbar + Focus/Firefighting/Energy | 1.4 | #10 | **מורחב** |
| 12 | MindMapEnergySelector | 1.4 | #9 | **חדש** |
| **Sprint 2: אינטראקטיביות** | | | | |
| 13 | Semantic Zoom | 2.1 | #11 | |
| 14 | Context Menu + "כמה זמן יש לי?" | 2.2 | #13 | **מורחב** |
| 15 | ClientExpandedNode (L/XL) | 2.3 | #8 | **חדש** |
| 16 | useEnergyFilter hook | 2.5 | #9, #12 | **חדש** |
| 17 | אזהרת שחיקה | 2.5 | #16 | **חדש** |
| 18 | ClientNodes + Clustering | 2.3-2.4 | #13 | |
| **Sprint 3: Inbox + Batch Work** | | | | |
| 19 | Inbox צף | 3.1 | #14 | |
| 20 | Brain Dump | 3.2 | #19 | |
| 21 | רשימת היום (T-Shirt sort) | 3.3 | #14, #9 | **מורחב** |
| 22 | AccumulationNode (מד-צבירה) | 3.4 | #7 | **חדש** |
| 23 | CheckpointNode (OCR) | 3.4 | #7 | **חדש** |
| 24 | StagingNode (סבבים) | 3.4 | #22 | **חדש** |
| 25 | תפריט ימני ייעודי לקליטה | 3.4 | #14, #22 | **חדש** |
| 26 | Pulse אוטומטי | 3.4 | #23 | **חדש** |
| 27 | Show on Map | 3.5 | #13 | |
| **Sprint 4: Gantt ADHD-Friendly** | | | | |
| 28 | GanttView + GanttTimeline + GanttBar | 4.1 | #3 | **חדש** |
| 29 | GanttHeatmap + useWorkloadCalculation | 4.2 | #28, #9 | **חדש** |
| 30 | GanttDeadlines (buffer כפול) | 4.2 | #28 | **חדש** |
| 31 | GanttDependencies (חצי תלויות) | 4.3 | #28 | **חדש** |
| 32 | useCollisionDetection + GanttAlerts | 4.4 | #29 | **חדש** |
| 33 | GanttMorningBriefing (3 ימים) | 4.5 | #28 | **חדש** |
| 34 | Drag-Drop + סנכרון Mind Map ↔ Gantt | 4.5 | #28, #5 | **חדש** |
| 35 | Toggle 🗺️📋📊 (מפה/קנבן/ציר זמן) | 4.5 | #28, #2 | **חדש** |
| **Sprint 5: שיפורים מתקדמים** | | | | |
| 36 | Calm Down + Pomodoro | 5.1 | #14 | |
| 37 | Cross-Linking | 5.2 | #18 | |
| 38 | Context Memory | 5.3 | #18 | |
| 39 | Dopamine Progress | 5.4 | #21 | |
| 40 | פידבק מורכבות (Self-Learning) | 5.5 | #8, #9 | **חדש** |
| **Sprint 6: שדרוג כל הלוחות** | | | | |
| 41 | ClientProgressBar + ComplexityBadge | 6.1 | #3 | **חדש** |
| 42 | שילוב Progress Bars ב-5 לוחות ריכוז | 6.1 | #41 | **חדש** |
| 43 | TaskCard צבעוני + גודל דינמי | 6.2 | #3 | **חדש** |
| 44 | Quick Wins sort ב-Kanban | 6.2 | #43 | **חדש** |
| 45 | Summary Cards → Quick Filters | 6.3 | #2 | **חדש** |
| 46 | Work Modes ב-Sidebar (4 מצבים) | 6.4 | - | **חדש** |
| 47 | Auto Mode לפי שעה | 6.4 | #46 | **חדש** |
| 48 | Morning Briefing ב-Home | 6.5 | #9, #33 | **חדש** |
| 49 | T-Shirt Budget ב-WeeklyPlanning | 6.5 | #9 | **חדש** |
| 50 | שדרוגי כספיים + לקוחות | 6.6 | #41 | **חדש** |

### קריטריונים להצלחה

1. **Sprint 1:** מפה עם כל הענפים, צבעי סטטוס, deep links, T-Shirt sizing, Energy Matching
2. **Sprint 2:** Semantic zoom, תפריט ימני, L/XL expansion, Energy Filter, אזהרת שחיקה
3. **Sprint 3:** Inbox + Brain Dump + רשימת יום + תהליכי קליטה (מד-צבירה, OCR, סבבים)
4. **Sprint 4:** Gantt עם Heatmap, Buffer Deadlines, Collision Alerts, Morning Briefing, סנכרון דו-כיווני
5. **Sprint 5:** Calm Down, Cross-Links, Memory, Dopamine, Self-Learning
6. **Sprint 6:** כל הלוחות הקיימים משודרגים (Progress Bars, צבעים, Quick Filters, Work Modes)

### סיכום כמותי

| מדד | ערך |
|-----|-----|
| סה"כ קבצים חדשים | ~40 |
| סה"כ קבצים מעודכנים (קיימים) | ~20 (Layout, index, כל הלוחות) |
| ספריות חדשות | 1 (@xyflow/react) |
| Custom Node Types (Mind Map) | 12 |
| Custom Gantt Components | 9 |
| Custom Hooks | 12 |
| עמודים קיימים שמקבלים "Show on Map" | 30+ |
| עמודים קיימים שמשודרגים | 15+ |
| שלבי יישום | 6 sprints |
| שעות עבודה משוערות | ~145 שעות |

### משולש העבודה - הסיכום

```
              Mind Map (מרחב)
             "איפה הדברים?"
                  /\
                 /  \
                /    \
               / ADHD \
              / Friendly\
             /    CRM    \
            /______________\
  Kanban (סטטוס)         Gantt (זמן)
  "מה אני עושה?"        "מתי זה קורה?"
```

**3 תצוגות, מקור נתונים אחד, סנכרון מלא.**
